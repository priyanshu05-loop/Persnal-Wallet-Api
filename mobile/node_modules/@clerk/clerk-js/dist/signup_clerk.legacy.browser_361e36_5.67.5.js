"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["710"],{95518:function(e,i,t){t.d(i,{Vh:()=>h,Vs:()=>g,bx:()=>p,mQ:()=>b,s2:()=>f,t3:()=>d,xT:()=>u}),t(28419),t(56113),t(65027);var r=t(32208),l=t(7772),n=t(50043),a=t(90577);let o=e=>i=>"safeIdentifier"in i&&i.safeIdentifier===e;function s(e){if((0,r.iW)()){let i=e.find(e=>{let{strategy:i}=e;return"passkey"===i});if(i)return i}return null}function d(e,i,t){return e&&0!==e.length?t===l.kJ.Password?function(e,i){let t=s(e);if(t)return t;let r=e.sort(a.sZ)[0];return"password"===r.strategy?r:e.find(o(i))||r||null}(e,i):function(e,i){let t=s(e);if(t)return t;let r=e.sort(a.b8),l=r.find(o(i));if(l)return l;let n=r[0];return"email_link"===n.strategy?n:e.find(o(i))||n||null}(e,i):null}let c=["passkey","email_code","password","phone_code","email_link"];function u(e){return!!e&&c.includes(e.strategy)}function p(e){if(!e||0===e.length)return null;let i=e.find(e=>"totp"===e.strategy);if(i)return i;let t=e.find(e=>"phone_code"===e.strategy);return t||e[0]}let m=["reset_password_phone_code","reset_password_email_code"],h=e=>!!e&&m.includes(e),v=e=>/^\S+@\S+\.\S+$/.test(e);function f(e){return"tel"===e.type?"phoneNumber":v(e.value)?"emailAddress":"username"}let g=(e,i,t)=>{var r,l;if(!i)return null;let a=null===(r=e.find(e=>"strategy"===e.id))||void 0===r?void 0:r.value;if(a&&"phone_code"!==a)return null;let o=null===(l=e.find(e=>e.id===t))||void 0===l?void 0:l.value;if(!o||!(null==o?void 0:o.startsWith("+")))return null;let s=(0,n.jR)(o,i);return"sms"===s?null:s},b=(e,i,t)=>{if(!e||!i||"phoneNumber"!==i||!t||!(null==t?void 0:t.startsWith("+")))return null;let r=(0,n.jR)(t,e);return"sms"===r?null:r}},96508:function(e,i,t){t.r(i),t.d(i,{SignUp:()=>Y,SignUpSSOCallback:()=>Z,SignUpContinue:()=>P,SignUpStart:()=>B,SignUpModal:()=>j,SignUpVerifyEmail:()=>D,SignUpVerifyPhone:()=>X});var r=t(69180),l=t(83799),n=t(69144),a=t(7508),o=t(15112),s=t(43812),d=t(43064),c=t(4511),u=t(24676);t(65223),t(93008),t(79876),t(28419),t(38062),t(50725);var p=t(77718),m=t(2672),h=t(50043),v=t(37321),f=t(81201);let g=e=>{var i,t,l,n,a,o,s,c,u,m,h,g,b,_;let{handleSubmit:y,fields:A,formState:C,canToggleEmailPhone:U,onlyLegalAcceptedMissing:S=!1,handleEmailPhoneToggle:N}=e,{showOptionalFields:P}=(0,d.useAppearance)().parsedLayout,E=e=>{var i;return("emailAddress"===e||"phoneNumber"===e)&&U?!!A[e]:!!A[e]&&(P||(null===(i=A[e])||void 0===i?void 0:i.required))};return(0,r.BX)(p.Form.Root,{onSubmit:y,gap:8,children:[!S&&(0,r.BX)(d.Col,{gap:6,children:[(E("firstName")||E("lastName"))&&(0,r.BX)(p.Form.ControlRow,{elementId:"name",sx:{[f.mqu.sm]:{flexWrap:"wrap"}},children:[E("firstName")&&(0,r.tZ)(p.Form.PlainInput,{...C.firstName.props,isRequired:null===(i=A.firstName)||void 0===i?void 0:i.required,isOptional:!(null===(t=A.firstName)||void 0===t?void 0:t.required)}),E("lastName")&&(0,r.tZ)(p.Form.PlainInput,{...C.lastName.props,isRequired:null===(l=A.lastName)||void 0===l?void 0:l.required,isOptional:!(null===(n=A.lastName)||void 0===n?void 0:n.required)})]}),E("username")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"username",children:(0,r.tZ)(p.Form.PlainInput,{...C.username.props,isRequired:null===(a=A.username)||void 0===a?void 0:a.required,isOptional:!(null===(o=A.username)||void 0===o?void 0:o.required)})}),E("emailAddress")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"emailAddress",children:(0,r.tZ)(p.Form.PlainInput,{...C.emailAddress.props,isRequired:null===(s=A.emailAddress)||void 0===s?void 0:s.required,isOptional:!(null===(c=A.emailAddress)||void 0===c?void 0:c.required),isDisabled:null===(u=A.emailAddress)||void 0===u?void 0:u.disabled,actionLabel:U?(0,d.localizationKeys)("signUp.start.actionLink__use_phone"):void 0,onActionClicked:U?()=>N("phoneNumber"):void 0})}),E("phoneNumber")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"phoneNumber",children:(0,r.tZ)(p.Form.PhoneInput,{...C.phoneNumber.props,isRequired:null===(m=A.phoneNumber)||void 0===m?void 0:m.required,isOptional:!(null===(h=A.phoneNumber)||void 0===h?void 0:h.required),actionLabel:U?(0,d.localizationKeys)("signUp.start.actionLink__use_email"):void 0,onActionClicked:U?()=>N("emailAddress"):void 0})}),E("password")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"password",children:(0,r.tZ)(p.Form.PasswordInput,{...C.password.props,isRequired:null===(g=A.password)||void 0===g?void 0:g.required,isOptional:!(null===(b=A.password)||void 0===b?void 0:b.required)})})]}),(0,r.BX)(d.Col,{center:!0,children:[(0,r.tZ)(v.S,{}),(0,r.BX)(d.Col,{gap:6,sx:{width:"100%"},children:[E("legalAccepted")&&(0,r.tZ)(p.Form.ControlRow,{elementId:"legalAccepted",children:(0,r.tZ)(p.LegalCheckbox,{...C.legalAccepted.props,isRequired:null===(_=A.legalAccepted)||void 0===_?void 0:_.required})}),(0,r.tZ)(p.Form.SubmitButton,{hasArrow:!0,localizationKey:(0,d.localizationKeys)("formButtonPrimary")})]})]})]})};var b=t(65027);let _=["emailAddress","phoneNumber","username","firstName","lastName","password","ticket","legalAccepted"];function y(e){return _.reduce((i,t)=>{let r=function(e,i){switch(e){case"emailAddress":return function(e){var i,t,r,l;let{attributes:n,hasTicket:a,hasEmail:o,activeCommIdentifierType:s,isProgressiveSignUp:d}=e;if(d){if(!((!a||a&&o)&&(null===(r=n.email_address)||void 0===r?void 0:r.enabled))||C(n,d)&&"emailAddress"!==s)return;return{required:!!(null===(l=n.email_address)||void 0===l?void 0:l.required),disabled:!!a&&!!o}}if((!a||a&&o)&&(null===(i=n.email_address)||void 0===i?void 0:i.enabled)&&(null===(t=n.email_address)||void 0===t?void 0:t.used_for_first_factor)&&"emailAddress"===s)return{required:!0,disabled:!!a&&!!o}}(i);case"phoneNumber":return function(e){var i,t,r;let{attributes:l,hasTicket:n,activeCommIdentifierType:a,isProgressiveSignUp:o}=e;if(o){if(!(null===(t=l.phone_number)||void 0===t?void 0:t.enabled)||C(l,o)&&"phoneNumber"!==a)return;return{required:!!(null===(r=l.phone_number)||void 0===r?void 0:r.required)}}if(!n&&(null===(i=l.phone_number)||void 0===i?void 0:i.enabled)&&l.phone_number.used_for_first_factor&&"phoneNumber"===a)return{required:!0}}(i);case"password":return function(e){var i,t;if((null===(i=e.password)||void 0===i?void 0:i.enabled)&&e.password.required)return{required:!!(null===(t=e.password)||void 0===t?void 0:t.required)}}(i.attributes);case"ticket":return function(e){if(e)return{required:!0}}(i.hasTicket);case"legalAccepted":return function(e){if(e)return{required:!0}}(i.legalConsentRequired);case"username":case"firstName":case"lastName":return function(e,i){var t,r;let l=(0,b.a1)(e);if(null===(t=i[l])||void 0===t?void 0:t.enabled)return{required:null===(r=i[l])||void 0===r?void 0:r.required}}(e,i.attributes);default:return}}(t,e);return r&&(i[t]=r),i},{})}let A=(e,i,t)=>{if(null==t?void 0:t.emailAddress)return"emailAddress";if(null==t?void 0:t.phoneNumber)return"phoneNumber";if(C(e,i))return"emailAddress";let{email_address:r,phone_number:l}=e;return((null==r?void 0:r.enabled)&&i?r.required:null==r?void 0:r.used_for_first_factor)?"emailAddress":((null==l?void 0:l.enabled)&&i?l.required:null==l?void 0:l.used_for_first_factor)?"phoneNumber":null};function C(e,i){let{email_address:t,phone_number:r}=e;return!!(i?(null==t?void 0:t.enabled)&&(null==r?void 0:r.enabled)&&!t.required&&!r.required:(null==t?void 0:t.used_for_first_factor)&&(null==r?void 0:r.used_for_first_factor))}var U=t(80138);let S=n.memo(e=>{let i=(0,l.cL)(),{navigate:t}=(0,u.useRouter)(),n=(0,p.useCardState)(),a=(0,s.useSignUpContext)(),o=(0,s.useCoreSignUp)(),d=a.ssoCallbackUrl,c=a.afterSignUpUrl||"/",m="popup"===a.oauthFlow||"auto"===a.oauthFlow&&(0,h.tc)(),{continueSignUp:v=!1,onAlternativePhoneCodeProviderClick:f,...g}=e;return(0,r.tZ)(U.L,{...g,idleAfterDelay:!m,oauthCallback:i=>{if(m){let t=window.open("about:blank","","width=600,height=800"),r=setInterval(()=>{(!t||t.closed)&&(clearInterval(r),n.setIdle())},500);return o.authenticateWithPopup({strategy:i,redirectUrl:d,redirectUrlComplete:c,popup:t,continueSignUp:v,unsafeMetadata:a.unsafeMetadata,legalAccepted:e.legalAccepted,oidcPrompt:a.oidcPrompt}).catch(e=>(0,h.S3)(e,[],n.setError))}return o.authenticateWithRedirect({continueSignUp:v,redirectUrl:d,redirectUrlComplete:c,strategy:i,unsafeMetadata:a.unsafeMetadata,legalAccepted:e.legalAccepted,oidcPrompt:a.oidcPrompt}).catch(e=>(0,h.S3)(e,[],n.setError))},web3Callback:r=>i.authenticateWithWeb3({customNavigate:t,redirectUrl:c,signUpContinueUrl:"continue",unsafeMetadata:a.unsafeMetadata,strategy:r,legalAccepted:e.legalAccepted}).catch(e=>(0,h.Ht)(e,n.setError)),alternativePhoneCodeCallback:e=>{null==f||f(e)}})});var N=t(46052);let P=(0,p.withCardStateProvider)(function(){var e,i;let t=(0,m.v)(),a=(0,l.cL)(),{navigate:o}=(0,u.useRouter)(),{displayConfig:c,userSettings:v}=(0,s.useEnvironment)(),{attributes:f,usernameSettings:b}=v,{t:_,locale:U}=(0,d.useLocalizations)(),{afterSignUpUrl:P,signInUrl:E,unsafeMetadata:Z,initialValues:w={},isCombinedFlow:I}=(0,s.useSignUpContext)(),z=(0,s.useCoreSignUp)(),k=!!n.useContext(s.SignInContext),L=!!(I&&k),R=v.signUp.progressive,[F,K]=n.useState(A(f,v.signUp.progressive)),T=(0,s.useSignUpContext)(),B={firstName:(0,h.Yp)("firstName",w.firstName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__firstName")}),lastName:(0,h.Yp)("lastName",w.lastName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__lastName")}),emailAddress:(0,h.Yp)("emailAddress",w.emailAddress||z.emailAddress||"",{type:"email",label:(0,d.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__emailAddress")}),username:(0,h.Yp)("username",w.username||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__username"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__username"),transformer:e=>e.trim(),buildErrorMessage:e=>(0,h.fq)(e,{t:_,locale:U,usernameSettings:b})}),phoneNumber:(0,h.Yp)("phoneNumber",w.phoneNumber||"",{type:"tel",label:(0,d.localizationKeys)("formFieldLabel__phoneNumber"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__phoneNumber")}),password:(0,h.Yp)("password","",{type:"password",label:(0,d.localizationKeys)("formFieldLabel__password"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__password"),validatePassword:!0}),legalAccepted:(0,h.Yp)("legalAccepted","",{type:"checkbox",label:"",defaultChecked:!1,isRequired:v.signUp.legal_consent_enabled||!1})},O=(0,n.useMemo)(()=>z.missingFields&&1===z.missingFields.length&&"legal_accepted"===z.missingFields[0]&&z.unverifiedFields&&0===z.unverifiedFields.length,[z.missingFields,z.unverifiedFields]);if((0,n.useEffect)(()=>{z.id||!0===a.__internal_setActiveInProgress||o(c.signUpUrl)},[]),!z.id)return(0,r.tZ)(p.LoadingCard,{});let q=!!B.emailAddress.value,x=(null===(i=z.verifications)||void 0===i?void 0:null===(e=i.externalAccount)||void 0===e?void 0:e.status)=="verified",M=y({attributes:f,hasEmail:q,activeCommIdentifierType:F,signUp:z,isProgressiveSignUp:R,legalConsentRequired:v.signUp.legal_consent_enabled});!function(e,i){if(i){var t,r,l,n,a,o,s,d;let c=!!i.emailAddress,u=(null===(r=i.verifications)||void 0===r?void 0:null===(t=r.emailAddress)||void 0===t?void 0:t.status)==="verified",p=(null===(n=i.verifications)||void 0===n?void 0:null===(l=n.phoneNumber)||void 0===l?void 0:l.status)==="verified",m=(null===(o=i.verifications)||void 0===o?void 0:null===(a=o.externalAccount)||void 0===a?void 0:a.status)==="verified",h=(null===(d=i.verifications)||void 0===d?void 0:null===(s=d.web3Wallet)||void 0===s?void 0:s.status)==="verified",v=null!==i.legalAcceptedAt;c&&u&&delete e.emailAddress,p&&delete e.phoneNumber,(m||h)&&delete e.password,i.firstName&&delete e.firstName,i.lastName&&delete e.lastName,i.username&&delete e.username,v&&delete e.legalAccepted,Object.entries(e).forEach(i=>{let[t,r]=i;r&&!r.required&&delete e[t]})}}(M,z);let D=v.authenticatableSocialStrategies,V=async e=>{var i,r;e.preventDefault();let l=Object.entries(M).reduce((e,i)=>{let[t,r]=i;return[...e,...r&&B[t]?[B[t]]:[]]},[]);Z&&l.push({id:"unsafeMetadata",value:Z});let n=!!(null===(i=l.find(e=>"emailAddress"===e.id))||void 0===i?void 0:i.value),s=!!(null===(r=l.find(e=>"phoneNumber"===e.id))||void 0===r?void 0:r.value);return z.missingFields.includes("email_address")&&z.missingFields.includes("phone_number")&&!n&&!s&&C(f,R)&&(l.push(B.emailAddress),l.push(B.phoneNumber)),t.setLoading(),t.setError(void 0),z.update((0,h.ni)(l)).then(e=>(0,N.completeSignUpFlow)({signUp:e,verifyEmailPath:"./verify-email-address",verifyPhonePath:"./verify-phone-number",handleComplete:()=>a.setActive({session:e.createdSessionId,redirectUrl:P}),navigate:o,oidcPrompt:T.oidcPrompt})).catch(e=>(0,h.S3)(e,l,t.setError)).finally(()=>t.setIdle())},X=C(f,R),H=!x&&D.length>0,W=O?(0,d.localizationKeys)("signUp.legalConsent.continue.title"):(0,d.localizationKeys)("signUp.continue.title"),Y=O?(0,d.localizationKeys)("signUp.legalConsent.continue.subtitle"):(0,d.localizationKeys)("signUp.continue.subtitle");return(0,r.tZ)(d.Flow.Part,{part:"complete",children:(0,r.BX)(p.Card.Root,{children:[(0,r.BX)(p.Card.Content,{children:[(0,r.BX)(p.Header.Root,{showLogo:!0,children:[(0,r.tZ)(p.Header.Title,{localizationKey:W}),(0,r.tZ)(p.Header.Subtitle,{localizationKey:Y})]}),(0,r.tZ)(p.Card.Alert,{children:t.error}),(0,r.tZ)(d.Flex,{direction:"col",elementDescriptor:d.descriptors.main,gap:8,children:(0,r.BX)(p.SocialButtonsReversibleContainerWithDivider,{children:[H&&!O&&(0,r.tZ)(S,{enableOAuthProviders:H,enableWeb3Providers:!1,enableAlternativePhoneCodeProviders:!1,continueSignUp:!0}),(0,r.tZ)(g,{handleSubmit:V,fields:M,formState:B,onlyLegalAcceptedMissing:O,canToggleEmailPhone:X,handleEmailPhoneToggle:e=>{C(f,R)&&K(e)}})]})})]}),(0,r.tZ)(p.Card.Footer,{children:L?null:(0,r.BX)(p.Card.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Card.ActionText,{localizationKey:(0,d.localizationKeys)("signUp.continue.actionText")}),(0,r.tZ)(p.Card.ActionLink,{localizationKey:(0,d.localizationKeys)("signUp.continue.actionLink"),to:L?"../../":a.buildUrlWithAuth(E)})]})})]})})});var E=t(8969);let Z=(0,E.sN)(E.L);var w=t(36543),I=t(80753),z=t(24029),k=t(12464),L=t(95518),R=t(93234),F=t(63610);let K=()=>{let e=(0,l.cL)(),i=(0,m.v)(),{navigate:t}=(0,u.useRouter)(),{signInUrl:n,waitlistUrl:a}=(0,s.useSignUpContext)(),o=(0,R.H)(),{userSettings:c}=(0,s.useEnvironment)(),{mode:h}=c.signUp,v=async()=>{await t(e.buildUrlWithAuth(a))},f=h===I.ci.RESTRICTED?(0,d.localizationKeys)("signUp.restrictedAccess.subtitle"):(0,d.localizationKeys)("signUp.restrictedAccess.subtitleWaitlist");return(0,r.BX)(p.Card.Root,{children:[(0,r.BX)(p.Card.Content,{children:[(0,r.BX)(p.Header.Root,{showLogo:!0,children:[(0,r.tZ)(d.Icon,{icon:F.gO,sx:e=>({margin:"auto",width:e.sizes.$10,height:e.sizes.$10})}),(0,r.tZ)(p.Header.Title,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.title")}),(0,r.tZ)(p.Header.Subtitle,{localizationKey:f})]}),(0,r.tZ)(p.Card.Alert,{children:i.error}),h===I.ci.RESTRICTED&&o&&(0,r.tZ)(d.Flex,{direction:"col",gap:4,children:(0,r.tZ)(d.Button,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.blockButton__emailSupport"),onClick:()=>{window.location.href="mailto:".concat(o)}})}),h===I.ci.WAITLIST&&(0,r.tZ)(d.Flex,{direction:"col",gap:4,children:(0,r.tZ)(d.Button,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.blockButton__joinWaitlist"),onClick:v})})]}),(0,r.tZ)(p.Card.Footer,{children:(0,r.BX)(p.Card.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Card.ActionText,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.actionText")}),(0,r.tZ)(p.Card.ActionLink,{localizationKey:(0,d.localizationKeys)("signUp.restrictedAccess.actionLink"),to:e.buildUrlWithAuth(n)})]})})]})},T=e=>{var i,t,l,n;let{handleSubmit:a,fields:o,formState:s,onUseAnotherMethod:c,phoneCodeProvider:u}=e,{providerToDisplayData:m,strategyToDisplayData:h}=(0,k.vO)(),f=u.name,g=u.channel,b=(0,p.useCardState)();return(0,r.tZ)(p.Card.Root,{children:(0,r.BX)(p.Card.Content,{children:[(0,r.BX)(p.Header.Root,{showLogo:!0,showDivider:!0,children:[(0,r.tZ)(d.Col,{center:!0,children:(0,r.tZ)(d.Image,{src:null===(i=m[u.channel])||void 0===i?void 0:i.iconUrl,alt:"".concat(h[g].name," logo"),sx:e=>({width:e.sizes.$7,height:e.sizes.$7,maxWidth:"100%",marginBottom:e.sizes.$6})})}),(0,r.tZ)(p.Header.Title,{localizationKey:(0,d.localizationKeys)("signUp.start.alternativePhoneCodeProvider.title",{provider:f})}),(0,r.tZ)(p.Header.Subtitle,{localizationKey:(0,d.localizationKeys)("signUp.start.alternativePhoneCodeProvider.subtitle",{provider:f})})]}),(0,r.tZ)(p.Card.Alert,{children:b.error}),(0,r.tZ)(d.Flex,{direction:"col",elementDescriptor:d.descriptors.main,gap:6,children:(0,r.BX)(p.Form.Root,{onSubmit:a,gap:8,children:[(0,r.tZ)(d.Col,{gap:6,children:(0,r.tZ)(p.Form.ControlRow,{elementId:"phoneNumber",children:(0,r.tZ)(p.Form.PhoneInput,{...s.phoneNumber.props,label:(0,d.localizationKeys)("signUp.start.alternativePhoneCodeProvider.label",{provider:f}),isRequired:!0,isOptional:!1,actionLabel:void 0,onActionClicked:void 0})})}),(0,r.BX)(d.Col,{center:!0,children:[(0,r.tZ)(v.S,{}),(0,r.BX)(d.Col,{gap:6,sx:{width:"100%"},children:[!!o[l="legalAccepted"]&&(null===(n=o[l])||void 0===n?void 0:n.required)&&(0,r.tZ)(p.Form.ControlRow,{elementId:"legalAccepted",children:(0,r.tZ)(p.LegalCheckbox,{...s.legalAccepted.props,isRequired:null===(t=o.legalAccepted)||void 0===t?void 0:t.required})}),(0,r.tZ)(p.Form.SubmitButton,{hasArrow:!0,localizationKey:(0,d.localizationKeys)("formButtonPrimary")})]})]}),(0,r.tZ)(d.Col,{center:!0,children:(0,r.tZ)(d.Button,{variant:"link",colorScheme:"neutral",onClick:c,localizationKey:(0,d.localizationKeys)("signUp.start.alternativePhoneCodeProvider.actionLink")})})]})})]})})},B=(0,E.sN)((0,p.withCardStateProvider)(function(){let e=(0,m.v)(),i=(0,l.cL)(),t=(0,k._m)(),a=(0,s.useCoreSignUp)(),{showOptionalFields:o}=(0,d.useAppearance)().parsedLayout,{userSettings:c,authConfig:f}=(0,s.useEnvironment)(),{navigate:b}=(0,u.useRouter)(),{attributes:_}=c,{setActive:U}=(0,l.cL)(),P=(0,s.useSignUpContext)(),E=!!n.useContext(s.SignInContext),{afterSignUpUrl:Z,signInUrl:R,unsafeMetadata:F}=P,B=!!(P.isCombinedFlow&&E),[O,q]=n.useState(()=>{var e,i,t,r;return A(_,c.signUp.progressive,{phoneNumber:(null===(e=P.initialValues)||void 0===e?void 0:e.phoneNumber)===null?void 0:null===(i=P.initialValues)||void 0===i?void 0:i.phoneNumber,emailAddress:(null===(t=P.initialValues)||void 0===t?void 0:t.emailAddress)===null?void 0:null===(r=P.initialValues)||void 0===r?void 0:r.emailAddress,...B?{emailAddress:a.emailAddress,phoneNumber:a.phoneNumber}:{}})}),{t:x,locale:M}=(0,d.useLocalizations)(),D=P.initialValues||{},[V,X]=n.useState(null),[H,W]=n.useState(!1),{userSettings:{passwordSettings:Y,usernameSettings:j}}=(0,s.useEnvironment)(),{mode:G}=c.signUp,$={firstName:(0,h.Yp)("firstName",a.firstName||D.firstName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__firstName")}),lastName:(0,h.Yp)("lastName",a.lastName||D.lastName||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__lastName")}),emailAddress:(0,h.Yp)("emailAddress",a.emailAddress||D.emailAddress||"",{type:"email",label:(0,d.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__emailAddress")}),username:(0,h.Yp)("username",a.username||D.username||"",{type:"text",label:(0,d.localizationKeys)("formFieldLabel__username"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__username"),transformer:e=>e.trim(),buildErrorMessage:e=>(0,h.fq)(e,{t:x,locale:M,usernameSettings:j})}),phoneNumber:(0,h.Yp)("phoneNumber",a.phoneNumber||D.phoneNumber||"",{type:"tel",label:(0,d.localizationKeys)("formFieldLabel__phoneNumber"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__phoneNumber")}),legalAccepted:(0,h.Yp)("legalAccepted","",{type:"checkbox",label:"",defaultChecked:!1,isRequired:c.signUp.legal_consent_enabled||!1}),password:(0,h.Yp)("password","",{type:"password",label:(0,d.localizationKeys)("formFieldLabel__password"),placeholder:(0,d.localizationKeys)("formFieldInputPlaceholder__password"),validatePassword:!0,buildErrorMessage:e=>(0,h.GM)(e,{t:x,locale:M,passwordSettings:Y})}),ticket:(0,h.Yp)("ticket",(0,z.XV)("__clerk_ticket")||(0,z.XV)("__clerk_invitation_token")||"")},Q=!!$.ticket.value,J=!!$.emailAddress.value,ee=c.signUp.progressive,ei=y({attributes:_,hasTicket:Q,hasEmail:J,activeCommIdentifierType:O,isProgressiveSignUp:ee,legalConsentRequired:c.signUp.legal_consent_enabled}),et=()=>{$.ticket.value&&(t.setLoading(),e.setLoading(),a.create({strategy:"ticket",ticket:$.ticket.value}).then(e=>($.emailAddress.setValue(e.emailAddress||""),"missing_requirements"===e.status&&W(!0),(0,N.completeSignUpFlow)({signUp:e,verifyEmailPath:"verify-email-address",verifyPhonePath:"verify-phone-number",handleComplete:()=>((0,z.xy)("__clerk_ticket"),(0,z.xy)("__clerk_invitation_token"),U({session:e.createdSessionId,redirectUrl:Z})),navigate:b}))).catch(i=>{$.ticket.setValue(""),(0,h.S3)(i,[],e.setError)}).finally(()=>{t.setIdle(),e.setIdle()}))};n.useLayoutEffect(()=>{et()},[]),n.useEffect(()=>{(async function(){let i=a.verifications.externalAccount.error;if(i){switch(i.code){case I.O1.NOT_ALLOWED_TO_SIGN_UP:case I.O1.OAUTH_ACCESS_DENIED:case I.O1.NOT_ALLOWED_ACCESS:case I.O1.SAML_USER_ATTRIBUTE_MISSING:case I.O1.OAUTH_EMAIL_DOMAIN_RESERVED_BY_SAML:case I.O1.USER_LOCKED:case I.O1.ENTERPRISE_SSO_USER_ATTRIBUTE_MISSING:case I.O1.ENTERPRISE_SSO_EMAIL_ADDRESS_DOMAIN_MISMATCH:case I.O1.ENTERPRISE_SSO_HOSTED_DOMAIN_MISMATCH:case I.O1.SAML_EMAIL_ADDRESS_DOMAIN_MISMATCH:case I.O1.ORGANIZATION_MEMBERSHIP_QUOTA_EXCEEDED_FOR_SSO:case I.O1.CAPTCHA_INVALID:case I.O1.FRAUD_DEVICE_BLOCKED:case I.O1.FRAUD_ACTION_BLOCKED:case I.O1.SIGNUP_RATE_LIMIT_EXCEEDED:e.setError(i);break;default:e.setError("Unable to complete action at this time. If the problem persists please contact support.")}await a.create({})}})()},[]);let er=async i=>{var t,r;let l;i.preventDefault();let n=Object.entries(ei).reduce((e,i)=>{let[t,r]=i;return e.push(...r&&$[t]?[$[t]]:[]),e},[]);if(F&&n.push({id:"unsafeMetadata",value:F}),ei.ticket){let e=()=>{};n.push({id:"strategy",value:"ticket",clearFeedback:e,setValue:e,onChange:e,setError:e})}let o=(null==V?void 0:V.channel)||(0,L.Vs)(n,f.preferredChannels,"phoneNumber");if(o){let e=()=>{};n.push({id:"strategy",value:"phone_code",clearFeedback:e,setValue:e,onChange:e,setError:e}),n.push({id:"channel",value:o,clearFeedback:e,setValue:e,onChange:e,setError:e})}let s=!!(null===(t=n.find(e=>"emailAddress"===e.id))||void 0===t?void 0:t.value),d=!!(null===(r=n.find(e=>"phoneNumber"===e.id))||void 0===r?void 0:r.value);!s&&!d&&C(_,ee)&&(n.push($.emailAddress),n.push($.phoneNumber)),e.setLoading(),e.setError(void 0);let c=P.ssoCallbackUrl,u=P.afterSignUpUrl||"/";return(ei.ticket?a.upsert((0,h.ni)(n)):a.create((0,h.ni)(n))).then(e=>(0,N.completeSignUpFlow)({signUp:e,verifyEmailPath:"verify-email-address",verifyPhonePath:"verify-phone-number",handleComplete:()=>U({session:e.createdSessionId,redirectUrl:Z}),navigate:b,redirectUrl:c,redirectUrlComplete:u,oidcPrompt:P.oidcPrompt})).catch(i=>(0,h.S3)(i,n,e.setError)).finally(()=>e.setIdle())};if(t.isLoading)return(0,r.tZ)(p.LoadingCard,{});let el=C(_,ee),en=Object.entries(ei).filter(e=>{let[i,t]=e;return o||(null==t?void 0:t.required)}),ea=function(e){let{authenticatableSocialStrategies:i,web3FirstFactors:t}=e;return e.hasValidAuthFactor||!i.length&&!t.length}(c)&&en.length>0,eo=(!Q||H)&&c.authenticatableSocialStrategies.length>0,es=!Q&&c.web3FirstFactors.length>0,ed=!Q&&c.alternativePhoneCodeChannels.length>0;return G===I.ci.PUBLIC||Q?(0,r.tZ)(d.Flow.Part,{part:"start",children:V?(0,r.tZ)(T,{handleSubmit:er,fields:ei,formState:$,onUseAnotherMethod:()=>{X(null)},phoneCodeProvider:V}):(0,r.BX)(p.Card.Root,{children:[(0,r.BX)(p.Card.Content,{children:[(0,r.BX)(p.Header.Root,{showLogo:!0,children:[(0,r.tZ)(p.Header.Title,{localizationKey:B?(0,d.localizationKeys)("signUp.start.titleCombined"):(0,d.localizationKeys)("signUp.start.title")}),(0,r.tZ)(p.Header.Subtitle,{localizationKey:B?(0,d.localizationKeys)("signUp.start.subtitleCombined"):(0,d.localizationKeys)("signUp.start.subtitle")})]}),(0,r.tZ)(p.Card.Alert,{children:e.error}),(0,r.BX)(d.Flex,{direction:"col",elementDescriptor:d.descriptors.main,gap:6,children:[(0,r.BX)(p.SocialButtonsReversibleContainerWithDivider,{children:[(eo||es||ed)&&(0,r.tZ)(S,{enableOAuthProviders:eo,enableWeb3Providers:es,enableAlternativePhoneCodeProviders:ed,onAlternativePhoneCodeProviderClick:e=>{X((0,w.H)(e)||null)},continueSignUp:H,legalAccepted:!!$.legalAccepted.checked||void 0}),ea&&(0,r.tZ)(g,{handleSubmit:er,fields:ei,formState:$,canToggleEmailPhone:el,handleEmailPhoneToggle:e=>{C(_,ee)&&q(e)}})]}),!ea&&(0,r.tZ)(v.S,{})]})]}),(0,r.tZ)(p.Card.Footer,{children:(0,r.BX)(p.Card.Action,{elementId:"signUp",children:[(0,r.tZ)(p.Card.ActionText,{localizationKey:(0,d.localizationKeys)("signUp.start.actionText")}),(0,r.tZ)(p.Card.ActionLink,{localizationKey:(0,d.localizationKeys)("signUp.start.actionLink"),to:B?"../":i.buildUrlWithAuth(R)})]})})]})}):(0,r.tZ)(K,{})})),O=e=>{let{afterSignUpUrl:i}=(0,s.useSignUpContext)(),{setActive:t}=(0,l.cL)(),{navigate:n}=(0,u.useRouter)();return(0,r.tZ)(p.VerificationCodeCard,{cardTitle:e.cardTitle,cardSubtitle:e.cardSubtitle,resendButton:e.resendButton,onCodeEntryFinishedAction:(r,l,a)=>{e.attempt(r).then(async e=>(await l(),(0,N.completeSignUpFlow)({signUp:e,verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number",continuePath:"../continue",handleComplete:()=>t({session:e.createdSessionId,redirectUrl:i}),navigate:n}))).catch(e=>a(e))},onResendCodeClicked:e.prepare,safeIdentifier:e.safeIdentifier,onIdentityPreviewEditClicked:()=>n("../",{searchParams:(0,z.z3)()}),alternativeMethodsLabel:e.alternativeMethodsLabel,onShowAlternativeMethodsClicked:e.onShowAlternativeMethodsClicked,showAlternativeMethods:e.showAlternativeMethods})},q=()=>{let e=(0,s.useCoreSignUp)(),i=(0,p.useCardState)(),t=e.verifications.emailAddress.status,l=!e.status||"verified"===t;return(0,k.ib)(l?void 0:()=>e.prepareEmailAddressVerification({strategy:"email_code"}).catch(e=>(0,h.S3)(e,[],i.setError)),{name:"prepare",strategy:"email_code",number:e.emailAddress},{staleTime:100}),(0,r.tZ)(d.Flow.Part,{part:"emailCode",children:(0,r.tZ)(O,{cardTitle:(0,d.localizationKeys)("signUp.emailCode.title"),cardSubtitle:(0,d.localizationKeys)("signUp.emailCode.subtitle"),inputLabel:(0,d.localizationKeys)("signUp.emailCode.formSubtitle"),resendButton:(0,d.localizationKeys)("signUp.emailCode.resendButton"),prepare:()=>{if(!l)return e.prepareEmailAddressVerification({strategy:"email_code"}).catch(e=>(0,h.S3)(e,[],i.setError))},attempt:i=>e.attemptEmailAddressVerification({code:i}),safeIdentifier:e.emailAddress})})};var x=t(14814);let M=()=>{let{t:e}=(0,d.useLocalizations)(),i=(0,s.useCoreSignUp)(),t=(0,s.useSignUpContext)(),{afterSignUpUrl:a}=t,o=(0,m.v)(),{navigate:c}=(0,u.useRouter)(),{setActive:v}=(0,l.cL)(),[f,g]=n.useState(!1),{startEmailLinkFlow:b,cancelEmailLinkFlow:_}=(0,x.E)(i);n.useEffect(()=>{y()},[]);let y=()=>b({redirectUrl:t.emailLinkRedirectUrl}).then(e=>A(e)).catch(e=>{(0,h.S3)(e,[],o.setError)}),A=async i=>{let t=i.verifications.emailAddress;"expired"===t.status?o.setError(e((0,d.localizationKeys)("formFieldError__verificationLinkExpired"))):t.verifiedFromTheSameClient()?g(!0):await (0,N.completeSignUpFlow)({signUp:i,continuePath:"../continue",verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number",handleComplete:()=>v({session:i.createdSessionId,redirectUrl:a}),navigate:c})};return f?(0,r.tZ)(E.Ej,{title:(0,d.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,d.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitleNewTab"),status:"verified_switch_tab"}):(0,r.tZ)(d.Flow.Part,{part:"emailLink",children:(0,r.tZ)(p.VerificationLinkCard,{cardTitle:(0,d.localizationKeys)("signUp.emailLink.title"),cardSubtitle:(0,d.localizationKeys)("signUp.emailLink.subtitle"),formTitle:(0,d.localizationKeys)("signUp.emailLink.formTitle"),formSubtitle:(0,d.localizationKeys)("signUp.emailLink.formSubtitle"),resendButton:(0,d.localizationKeys)("signUp.emailLink.resendButton"),onResendCodeClicked:()=>{_(),y()},safeIdentifier:i.emailAddress})})},D=(0,p.withCardStateProvider)(()=>{var e,i;let{userSettings:t}=(0,s.useEnvironment)(),{attributes:l}=t;return(null===(i=l.email_address)||void 0===i?void 0:null===(e=i.verifications)||void 0===e?void 0:e.includes("email_link"))?(0,r.tZ)(M,{}):(0,r.tZ)(q,{})}),V=(0,p.withCardStateProvider)(()=>{let e=(0,s.useCoreSignUp)(),i=(0,p.useCardState)(),t=e.verifications.phoneNumber.channel,l=e.verifications.phoneNumber.status,n=!e.status||"verified"===l,a=!!t&&"sms"!==t,o=a?t:void 0;(0,k.ib)(n||a?void 0:()=>e.preparePhoneNumberVerification({strategy:"phone_code",channel:void 0}).catch(e=>(0,h.S3)(e,[],i.setError)),{name:"signUp.preparePhoneNumberVerification",strategy:"phone_code",number:e.phoneNumber},{staleTime:100});let c=(0,d.localizationKeys)("signUp.phoneCode.title"),u=(0,d.localizationKeys)("signUp.phoneCode.subtitle"),m=(0,d.localizationKeys)("signUp.phoneCode.resendButton");if(a){var v;let e=null===(v=(0,w.H)(t))||void 0===v?void 0:v.name;c=(0,d.localizationKeys)("signUp.alternativePhoneCodeProvider.title",{provider:e}),u=(0,d.localizationKeys)("signUp.alternativePhoneCodeProvider.subtitle",{provider:e}),m=(0,d.localizationKeys)("signUp.alternativePhoneCodeProvider.resendButton")}return i.isLoading?(0,r.tZ)(p.LoadingCard,{}):(0,r.tZ)(d.Flow.Part,{part:"phoneCode",children:(0,r.tZ)(O,{cardTitle:c,cardSubtitle:u,resendButton:m,prepare:()=>{if(!n)return e.preparePhoneNumberVerification({strategy:"phone_code",channel:o}).catch(e=>(0,h.S3)(e,[],i.setError))},attempt:i=>e.attemptPhoneNumberVerification({code:i}),safeIdentifier:e.phoneNumber,alternativeMethodsLabel:a?(0,d.localizationKeys)("footerActionLink__alternativePhoneCodeProvider"):void 0,onShowAlternativeMethodsClicked:a?()=>{i.setLoading(),i.setError(void 0),e.preparePhoneNumberVerification({strategy:"phone_code",channel:void 0}).catch(e=>(0,h.S3)(e,[],i.setError)).finally(()=>i.setIdle())}:void 0,showAlternativeMethods:!!a||void 0})})}),X=()=>(0,r.tZ)(V,{});function H(){let e=(0,l.cL)();return n.useEffect(()=>{e.redirectToSignUp()},[]),null}function W(){(0,c.z)();let{__internal_setComponentNavigationContext:e}=(0,l.cL)(),{navigate:i,indexPath:t}=(0,u.useRouter)(),p=(0,s.useSignUpContext)();return n.useEffect(()=>null==e?void 0:e({indexPath:t,navigate:i}),[t,i]),(0,r.tZ)(d.Flow.Root,{flow:"signUp",children:(0,r.BX)(u.Switch,{children:[(0,r.tZ)(u.Route,{path:"verify-email-address",canActivate:e=>!!e.client.signUp.emailAddress,children:(0,r.tZ)(D,{})}),(0,r.tZ)(u.Route,{path:"verify-phone-number",canActivate:e=>!!e.client.signUp.phoneNumber,children:(0,r.tZ)(X,{})}),(0,r.tZ)(u.Route,{path:"sso-callback",children:(0,r.tZ)(Z,{signUpUrl:p.signUpUrl,signInUrl:p.signInUrl,signUpForceRedirectUrl:p.afterSignUpUrl,signInForceRedirectUrl:p.afterSignInUrl,secondFactorUrl:p.secondFactorUrl,continueSignUpUrl:"../continue",verifyEmailAddressUrl:"../verify-email-address",verifyPhoneNumberUrl:"../verify-phone-number"})}),(0,r.tZ)(u.Route,{path:"verify",children:(0,r.tZ)(o.$,{redirectUrlComplete:p.afterSignUpUrl,verifyEmailPath:"../verify-email-address",verifyPhonePath:"../verify-phone-number"})}),(0,r.BX)(u.Route,{path:"continue",children:[(0,r.tZ)(u.Route,{path:"verify-email-address",canActivate:e=>!!e.client.signUp.emailAddress,children:(0,r.tZ)(D,{})}),(0,r.tZ)(u.Route,{path:"verify-phone-number",canActivate:e=>!!e.client.signUp.phoneNumber,children:(0,r.tZ)(X,{})}),(0,r.tZ)(u.Route,{index:!0,children:(0,r.tZ)(P,{})})]}),(0,r.tZ)(u.Route,{path:"tasks",children:(0,r.tZ)(a.x7,{})}),(0,r.tZ)(u.Route,{index:!0,children:(0,r.tZ)(B,{})}),(0,r.tZ)(u.Route,{children:(0,r.tZ)(H,{})})]})})}W.displayName="SignUp";let Y=(0,s.withCoreSessionSwitchGuard)(W),j=e=>{let i={signInUrl:"/".concat(u.VIRTUAL_ROUTER_BASE_PATH,"/sign-in"),waitlistUrl:"/".concat(u.VIRTUAL_ROUTER_BASE_PATH,"/waitlist"),...e};return(0,r.tZ)(u.Route,{path:"sign-up",children:(0,r.tZ)(s.SignUpContext.Provider,{value:{componentName:"SignUp",...i,routing:"virtual",mode:"modal"},children:(0,r.tZ)("div",{children:(0,r.tZ)(Y,{...i,routing:"virtual"})})})})}},46052:function(e,i,t){t.r(i),t.d(i,{completeSignUpFlow:()=>r.v});var r=t(65756)}}]);