"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["470"],{9140:function(e,t,r){r.d(t,{_:()=>y});var i=r(9180),o=r(3799),a=r(9144),n=r(8969),l=r(3812),s=r(7718),c=r(1085),d=r(43),u=r(207),m=r(4676),h=r(6917),f=r(3064),p=r(2464);let P=e=>{let{navigate:t}=(0,m.useRouter)(),{email:r,nextStep:o,onReset:n}=e,c=(0,s.useCardState)(),u=(0,l.useUserProfileContext)(),{startEnterpriseSSOLinkFlow:P}=(0,p.eq)(r);async function g(){await t(r.verification.externalVerificationRedirectURL?.href||"")}return a.useEffect(()=>{!function(){let{mode:e,componentName:t}=u;P({redirectUrl:"modal"===e?(0,h.bX)({url:window.location.href,componentName:t}):window.location.href}).then(()=>o()).catch(e=>(0,d.S3)(e,[],c.setError))}()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(f.Flex,{justify:"center",children:(0,i.tZ)(f.Button,{variant:"link",onClick:g,localizationKey:(0,f.localizationKeys)("userProfile.emailAddressPage.enterpriseSSOLink.formButton")})}),(0,i.tZ)(s.FormButtonContainer,{children:(0,i.tZ)(f.Button,{variant:"ghost",localizationKey:(0,f.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:f.descriptors.formButtonReset,onClick:n})})]})};var g=r(2786);let y=(0,s.withCardStateProvider)(e=>{let{emailId:t,onSuccess:r,onReset:m,disableAutoFocus:h=!1}=e,f=(0,s.useCardState)(),{user:p}=(0,o.aF)(),y=(0,l.useEnvironment)(),b=(0,o.WZ)(e=>p?.createEmailAddress({email:e})),S=a.useRef(p?.emailAddresses.find(e=>e.id===t)),C=Z(S.current,y),z=(0,n.a2)({defaultStep:+!!S.current,onNextStep:()=>f.setError(void 0)}),K=(0,d.Yp)("emailAddress","",{type:"email",label:(0,c.u1)("formFieldLabel__emailAddress"),placeholder:(0,c.u1)("formFieldInputPlaceholder__emailAddress"),isRequired:!0}),B=K.value.length>1&&p?.username!==K.value,x=async e=>{if(e.preventDefault(),p)return b(K.value).then(e=>{S.current=e,z.nextStep()}).catch(e=>(0,d.S3)(e,[K],f.setError))},_=v(C);return(0,i.BX)(n.en,{...z.props,children:[(0,i.tZ)(s.FormContainer,{headerTitle:e.title||(0,c.u1)("userProfile.emailAddressPage.title"),headerSubtitle:e.subtitle||(0,c.u1)("userProfile.emailAddressPage.formHint"),children:(0,i.BX)(s.Form.Root,{onSubmit:x,children:[(0,i.tZ)(s.Form.ControlRow,{elementId:K.id,children:(0,i.tZ)(s.Form.PlainInput,{...K.props,autoFocus:!h})}),(0,i.tZ)(s.FormButtons,{submitLabel:(0,c.u1)("userProfile.formButtonPrimary__add"),isDisabled:!B,onReset:m})]})}),(0,i.BX)(s.FormContainer,{headerTitle:(0,c.u1)("userProfile.emailAddressPage.verifyTitle"),headerSubtitle:(0,c.u1)(`${_}.formSubtitle`,{identifier:S.current?.emailAddress}),children:["email_link"===C&&(0,i.tZ)(g.K,{nextStep:r,email:S.current,onReset:m}),"email_code"===C&&(0,i.tZ)(u.H,{nextStep:r,identification:S.current,identifier:S.current?.emailAddress,prepareVerification:()=>S.current?.prepareVerification({strategy:"email_code"}),onReset:m}),"enterprise_sso"===C&&(0,i.tZ)(P,{nextStep:r,email:S.current,onReset:m})]})]})}),v=e=>{switch(e){case"email_code":return"userProfile.emailAddressPage.emailCode";case"enterprise_sso":return"userProfile.emailAddressPage.enterpriseSSOLink";case"email_link":return"userProfile.emailAddressPage.emailLink";default:throw Error(`Unsupported strategy for email verification: ${e}`)}},Z=(e,t)=>e?.matchesSsoConnection?"enterprise_sso":!function(e){let{userSettings:t}=e,{email_address:r}=t.attributes;return!!(r?.enabled&&r?.verifications.includes("email_link"))}(t)?"email_code":"email_link"},207:function(e,t,r){r.d(t,{H:()=>s});var i=r(9180),o=r(9144),a=r(3064),n=r(7718),l=r(43);let s=e=>{let t=(0,n.useCardState)(),{nextStep:r,identification:s,identifier:c,onReset:d,prepareVerification:u}=e,m=()=>u?.()?.catch(e=>l.S3(e,[],t.setError)),h=(0,n.useFieldOTP)({onCodeEntryFinished:(e,t,r)=>{s?.attemptVerification({code:e}).then(()=>t()).catch(r)},onResendCodeClicked:m,onResolve:r});return o.useEffect(()=>{m()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(n.Form.OTPInput,{...h,label:(0,a.localizationKeys)("userProfile.emailAddressPage.emailCode.formTitle"),description:(0,a.localizationKeys)("userProfile.emailAddressPage.emailCode.formSubtitle",{identifier:c}),resendButton:(0,a.localizationKeys)("userProfile.emailAddressPage.emailCode.resendButton"),centerAlign:!1}),(0,i.BX)(n.FormButtonContainer,{children:[(0,i.tZ)(a.Button,{isLoading:h.isLoading,localizationKey:(0,a.localizationKeys)("formButtonPrimary__verify"),elementDescriptor:a.descriptors.formButtonPrimary,onClick:h.onFakeContinue}),(0,i.tZ)(a.Button,{variant:"ghost",isDisabled:h.isLoading,localizationKey:(0,a.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:a.descriptors.formButtonReset,onClick:d})]})]})}},2786:function(e,t,r){r.d(t,{K:()=>m,M:()=>h});var i=r(9180),o=r(9144),a=r(8969),n=r(6749),l=r(3812),s=r(3064),c=r(7718),d=r(2464),u=r(43);let m=e=>{let{email:t,nextStep:r,onReset:a}=e,m=(0,c.useCardState)(),h=(0,l.useUserProfileContext)(),{startEmailLinkFlow:f}=(0,d.E2)(t),{displayConfig:p}=(0,l.useEnvironment)();function P(){let{routing:e}=h,t="virtual"===e?p.userProfileUrl:"";f({redirectUrl:(0,n.Uu)({ctx:h,baseUrl:t,intent:"profile"})}).then(()=>r()).catch(e=>(0,u.S3)(e,[],m.setError))}return o.useEffect(()=>{P()},[]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.VerificationLink,{resendButton:(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.resendButton"),onResendCodeClicked:P}),(0,i.tZ)(c.FormButtonContainer,{children:(0,i.tZ)(s.Button,{variant:"ghost",localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset,onClick:a})})]})},h=()=>(0,i.tZ)(a.Ej,{title:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitle"),status:"verified"})},9248:function(e,t,r){r.r(t),r.d(t,{UserProfile:()=>ts,UserProfileModal:()=>tc});var i=r(9180),o=r(9144),a=r(1673),n=r(3812),l=r(3064),s=r(7718),c=r(4676),d=r(1085);let u=e=>{let{pages:t}=(0,n.useUserProfileContext)();return(0,i.BX)(s.NavbarContextProvider,{children:[(0,i.tZ)(s.NavBar,{title:(0,d.u1)("userProfile.navbar.title"),description:(0,d.u1)("userProfile.navbar.description"),routes:t.routes,contentRef:e.contentRef}),e.children]})};var m=r(4995),h=r(5515),f=r(3799),p=r(6917),P=r(8969),g=r(9805),y=r(4709),v=r(2464),Z=r(43);let b=e=>{let{strategy:t}=e,r=(0,s.useCardState)(),{user:o}=(0,f.aF)(),{navigate:a}=(0,c.useRouter)(),{strategyToDisplayData:d}=(0,v.vO)(),{additionalOAuthScopes:u,componentName:m,mode:h}=(0,n.useUserProfileContext)(),g="modal"===h,y=(0,f.WZ)(()=>{let e=t.replace("oauth_",""),r=g?(0,p.bX)({url:window.location.href,componentName:m,socialProvider:e}):window.location.href,i=u?u[e]:[];return o?.createExternalAccount({strategy:t,redirectUrl:r,additionalScopes:i})}),b=d[t].iconUrl?(0,i.tZ)(l.Image,{isLoading:r.loadingMetadata===t,isDisabled:r.isLoading,elementDescriptor:l.descriptors.providerIcon,elementId:l.descriptors.providerIcon.setId(d[t].id),src:d[t].iconUrl,alt:`Connect ${d[t].name} account`,sx:e=>({width:e.sizes.$4})}):(0,i.tZ)(P.e_,{id:d[t].id,value:d[t].name,isLoading:r.loadingMetadata===t,isDisabled:r.isLoading});return(0,i.tZ)(s.ProfileSection.ActionMenuItem,{id:d[t].id,onClick:()=>{if(o)return r.setLoading(t),y().then(e=>{e&&e.verification?.externalVerificationRedirectURL&&((0,Z._v)(2e3).then(()=>r.setIdle(t)),a(e.verification.externalVerificationRedirectURL.href))}).catch(e=>{(0,Z.S3)(e,[],r.setError),r.setIdle(t)})},isDisabled:r.isLoading,variant:"ghost",isLoading:r.loadingMetadata===t,focusRing:!1,closeAfterClick:!1,localizationKey:(0,l.localizationKeys)("userProfile.connectedAccountPage.socialButtonsBlockButton",{provider:d[t].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:b},t)},S=({onClick:e})=>{let{user:t}=(0,f.aF)(),{strategies:r}=(0,v.vO)(),o=r.filter(e=>e.startsWith("oauth")),a=t?.verifiedExternalAccounts.map(e=>`oauth_${e.provider}`),n=o.filter(e=>!a.includes(e));return 0===n.length?null:(0,i.tZ)(s.ProfileSection.ActionMenu,{triggerLocalizationKey:(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.primaryButton"),id:"connectedAccounts",onClick:e,children:n.map(e=>(0,i.tZ)(b,{strategy:e},e))})},C=e=>{let{onSuccess:t,onReset:r}=e,{user:a}=(0,f.aF)(),{emailId:n}=e,s=a?.emailAddresses.find(e=>e.id===n),c=o.useRef(s?.emailAddress),d=s?.verification?.status==="verified"?(0,l.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine2"):void 0;return c.current?(0,i.tZ)(P.LE,{title:(0,l.localizationKeys)("userProfile.emailAddressPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine1",{identifier:c.current}),messageLine2:d,successMessage:(0,l.localizationKeys)("userProfile.emailAddressPage.removeResource.successMessage",{emailAddress:c.current}),deleteResource:()=>Promise.resolve(s?.destroy()),onSuccess:t,onReset:r}):null},z=e=>{let{phoneId:t,onSuccess:r,onReset:a}=e,{user:n}=(0,f.aF)(),s=n?.phoneNumbers.find(e=>e.id===t),c=o.useRef(s?.phoneNumber),d=s?.verification?.status==="verified"?(0,l.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine2"):void 0;return c.current?(0,i.tZ)(P.LE,{title:(0,l.localizationKeys)("userProfile.phoneNumberPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine1",{identifier:c.current}),messageLine2:d,successMessage:(0,l.localizationKeys)("userProfile.phoneNumberPage.removeResource.successMessage",{phoneNumber:c.current}),deleteResource:()=>Promise.resolve(s?.destroy()),onSuccess:r,onReset:a}):null},K=e=>{let{accountId:t,onSuccess:r,onReset:a}=e,{user:n}=(0,f.aF)(),s=n?.externalAccounts.find(e=>e.id===t),c=o.useRef(s?.provider),{providerToDisplayData:d}=(0,v.vO)();return c.current?(0,i.tZ)(P.LE,{title:(0,l.localizationKeys)("userProfile.connectedAccountPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine1",{identifier:d[c.current]?.name}),messageLine2:(0,l.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine2"),successMessage:(0,l.localizationKeys)("userProfile.connectedAccountPage.removeResource.successMessage",{connectedAccount:d[c.current]?.name}),deleteResource:()=>Promise.resolve(s?.destroy()),onSuccess:r,onReset:a}):null},B=e=>{let{user:t}=(0,f.aF)(),{walletId:r,onSuccess:a,onReset:n}=e,s=t?.web3Wallets.find(e=>e.id===r),c=o.useRef(s?.web3Wallet),d=s?.verification?.status==="verified"?(0,l.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine2"):void 0;return c.current?(0,i.tZ)(P.LE,{title:(0,l.localizationKeys)("userProfile.web3WalletPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine1",{identifier:c.current}),messageLine2:d,successMessage:(0,l.localizationKeys)("userProfile.web3WalletPage.removeResource.successMessage",{web3Wallet:c.current}),deleteResource:()=>Promise.resolve(s?.destroy()),onSuccess:a,onReset:n}):null},x=e=>{let{user:t}=(0,f.aF)(),{phoneId:r,onSuccess:a,onReset:n}=e,s=t?.phoneNumbers.find(e=>e.id===r),c=o.useRef(s?.phoneNumber);return c.current?(0,i.tZ)(P.LE,{title:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine1",{identifier:c.current}),messageLine2:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine2"),successMessage:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.successMessage",{mfaPhoneCode:c.current}),deleteResource:()=>Promise.resolve(s?.setReservedForSecondFactor({reserved:!1})),onSuccess:a,onReset:n}):null},_=e=>{let{onSuccess:t,onReset:r}=e,{user:o}=(0,f.aF)();return o?(0,i.tZ)(P.LE,{title:(0,l.localizationKeys)("userProfile.mfaTOTPPage.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine1"),messageLine2:(0,l.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine2"),successMessage:(0,l.localizationKeys)("userProfile.mfaTOTPPage.removeResource.successMessage"),deleteResource:o.disableTOTP,onSuccess:t,onReset:r}):null},R=e=>{let{onSuccess:t,onReset:r,passkey:o}=e;return(0,i.tZ)(P.LE,{title:(0,l.localizationKeys)("userProfile.passkeyScreen.removeResource.title"),messageLine1:(0,l.localizationKeys)("userProfile.passkeyScreen.removeResource.messageLine1",{name:o.name}),deleteResource:o.delete,onSuccess:t,onReset:r})},w=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(K,{onSuccess:t,onReset:t,...e})},F=["external_account_missing_refresh_token","oauth_fetch_user_error","oauth_token_exchange_error","external_account_email_address_verification_required"],k=(0,s.withCardStateProvider)(({shouldAllowCreation:e=!0})=>{let{user:t}=(0,f.aF)(),r=(0,s.useCardState)(),a=!!t?.externalAccounts?.length,[n,c]=(0,o.useState)(null);if(!t||!e&&!a)return null;let d=[...t.verifiedExternalAccounts,...t.unverifiedExternalAccounts.filter(e=>e.verification?.error)];return(0,i.BX)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.title"),centered:!1,id:"connectedAccounts",children:[(0,i.tZ)(s.Card.Alert,{children:r.error}),(0,i.BX)(g.a.Root,{value:n,onChange:c,children:[(0,i.tZ)(s.ProfileSection.ItemList,{id:"connectedAccounts",children:d.map(e=>(0,i.tZ)(T,{account:e},e.id))}),e&&(0,i.tZ)(S,{onClick:()=>c(null)})]})]})}),T=({account:e})=>{let{additionalOAuthScopes:t,componentName:r,mode:a}=(0,n.useUserProfileContext)(),{navigate:d}=(0,c.useRouter)(),{user:u}=(0,f.aF)(),m=(0,s.useCardState)(),h=e.id,y="modal"===a,b=y?(0,p.bX)({url:window.location.href,componentName:r}):window.location.href,S=(0,f.WZ)(()=>u?.createExternalAccount({strategy:e.verification.strategy,redirectUrl:b,additionalScopes:B}));if(!u)return null;let{providerToDisplayData:C}=(0,v.vO)(),z=e.username||e.emailAddress,K=e.verification?.error?.longMessage,B=function(e,t){if(!t)return[];let r=t[e.provider]||[],i=e.approvedScopes.split(" ");return 0===r.filter(e=>!i.includes(e)).length?[]:r}(e,t),x=B.length>0&&""!=e.approvedScopes,_=F.includes(e.verification?.error?.code||"")||x,R=_?(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.subtitle__disconnected"):K,k=async()=>{let t=y?(0,p.bX)({url:window.location.href,componentName:r}):window.location.href;try{let r;(r=x?await e.reauthorize({additionalScopes:B,redirectUrl:t}):await S())&&await d(r.verification.externalVerificationRedirectURL?.href||"")}catch(e){(0,Z.S3)(e,[],m.setError)}};return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"connectedAccounts",children:[(0,i.BX)(l.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$2}),children:[(0,i.tZ)(()=>C[e.provider].iconUrl?(0,i.tZ)(l.Image,{elementDescriptor:[l.descriptors.providerIcon],elementId:l.descriptors.socialButtonsProviderIcon.setId(e.provider),alt:C[e.provider].name,src:C[e.provider].iconUrl,sx:e=>({width:e.sizes.$4,flexShrink:0})}):(0,i.tZ)(P.e_,{id:e.provider,value:C[e.provider].name}),{}),(0,i.tZ)(l.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(l.Flex,{gap:1,center:!0,children:[(0,i.tZ)(l.Text,{sx:e=>({color:e.colors.$colorText}),children:`${C[e.provider].name}`}),(0,i.tZ)(l.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:z?`• ${z}`:""})]})})]}),(0,i.tZ)(I,{account:e})]}),_&&(0,i.BX)(l.Box,{sx:e=>({padding:`${e.sizes.$none} ${e.sizes.$none} ${e.sizes.$1x5} ${e.sizes.$8x5}`}),children:[(0,i.tZ)(l.Text,{colorScheme:"secondary",sx:e=>({paddingRight:e.sizes.$1x5,display:"inline-block"}),localizationKey:R}),(0,i.tZ)(l.Button,{sx:{display:"inline-block"},onClick:k,variant:"link",localizationKey:(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__connectionFailed")})]}),e.verification?.error?.code&&!_&&(0,i.tZ)(l.Text,{colorScheme:"danger",sx:e=>({padding:`${e.sizes.$none} ${e.sizes.$1x5} ${e.sizes.$1x5} ${e.sizes.$8x5}`}),children:K}),(0,i.tZ)(g.a.Open,{value:`remove-${h}`,children:(0,i.tZ)(g.a.Card,{variant:"destructive",children:(0,i.tZ)(w,{accountId:e.id})})})]},e.id)},I=({account:e})=>{let{open:t}=(0,y.XC)(),r=e.id,o=[{label:(0,l.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionTitle"),isDestructive:!0,onClick:()=>t(`remove-${r}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:o})},A=e=>t=>t.id===e?-1:1,X=e=>e.defaultSecondFactor?-1:1;function L(e){let t=[];return Object.entries(e).forEach(([,e])=>{e.used_for_second_factor&&t.push(...e.second_factors)}),t}function $(e,t){let r=L(e);return t.totpEnabled&&(r=r.filter(e=>"totp"!==e)),(t.backupCodeEnabled||!t.twoFactorEnabled)&&(r=r.filter(e=>"backup_code"!==e)),r}function E(e,t){if(!e)return[];let r=e.filter(e=>e.id===t),i=e.filter(e=>e.id!==t),o=i.filter(e=>e.verification?.status==="verified"),a=i.filter(e=>!!e.verification?.status&&e.verification?.status!=="verified"),n=i.filter(e=>!e.verification.status);return o.sort((e,t)=>e.id.localeCompare(t.id)),a.sort((e,t)=>e.verification?.expireAt&&t.verification?.expireAt?e.verification.expireAt.getTime()-t.verification.expireAt.getTime():0),[...r,...o,...a,...n]}var D=r(9140);let N=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(C,{onSuccess:t,onReset:t,...e})},O=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(D._,{onSuccess:t,onReset:t,...e})},W=({shouldAllowCreation:e=!0})=>{let{user:t}=(0,f.aF)();return(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.title"),centered:!1,id:"emailAddresses",children:(0,i.tZ)(g.a.Root,{children:(0,i.BX)(s.ProfileSection.ItemList,{id:"emailAddresses",children:[E(t?.emailAddresses,t?.primaryEmailAddressId).map(e=>{let r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"emailAddresses",children:[(0,i.BX)(l.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$1}),children:[(0,i.tZ)(l.Text,{sx:e=>({color:e.colors.$colorText}),truncate:!0,children:e.emailAddress}),t?.primaryEmailAddressId===r&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__unverified")})]}),(0,i.tZ)(M,{email:e})]}),(0,i.tZ)(g.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(g.a.Card,{variant:"destructive",children:(0,i.tZ)(N,{emailId:r})})}),(0,i.tZ)(g.a.Open,{value:`verify-${r}`,children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(O,{emailId:r})})})]},e.emailAddress)}),e&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(g.a.Trigger,{value:"add",children:(0,i.tZ)(s.ProfileSection.ArrowButton,{id:"emailAddresses",localizationKey:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.primaryButton")})}),(0,i.tZ)(g.a.Open,{value:"add",children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(O,{})})})]})]})})})},M=({email:e})=>{let t=(0,s.useCardState)(),{user:r}=(0,f.aF)(),{open:o}=(0,y.XC)(),a=e.id,n=r?.primaryEmailAddressId===a,c="verified"===e.verification.status,d=(0,f.WZ)(()=>r?.update({primaryEmailAddressId:a})),u=[n&&!c?{label:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__primary"),onClick:()=>o(`verify-${a}`)}:null,!n&&c?{label:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__nonPrimary"),onClick:()=>{d().catch(e=>(0,Z.S3)(e,[],t.setError))}}:null,n||c?null:{label:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__unverified"),onClick:()=>o(`verify-${a}`)},{label:(0,l.localizationKeys)("userProfile.start.emailAddressesSection.destructiveAction"),isDestructive:!0,onClick:()=>o(`remove-${a}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:u})},U=()=>{let{user:e}=(0,f.aF)(),t=e?.enterpriseAccounts.filter(({enterpriseConnection:e})=>e?.active);return t?.length?(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.enterpriseAccountsSection.title"),id:"enterpriseAccounts",centered:!1,children:(0,i.tZ)(s.ProfileSection.ItemList,{id:"enterpriseAccounts",children:t.map(e=>(0,i.tZ)(q,{account:e},e.id))})}):null},q=({account:e})=>{let t=e.emailAddress,r=e?.enterpriseConnection?.name,o=e.verification?.error?.longMessage;return(0,i.BX)(s.ProfileSection.Item,{id:"enterpriseAccounts",sx:e=>({gap:e.space.$2,justifyContent:"start"}),children:[(0,i.tZ)(H,{account:e}),(0,i.tZ)(l.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(l.Flex,{gap:1,center:!0,children:[(0,i.tZ)(l.Text,{truncate:!0,colorScheme:"body",children:r}),(0,i.tZ)(l.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:t?`• ${t}`:""}),o&&(0,i.tZ)(l.Badge,{colorScheme:"danger",localizationKey:(0,l.localizationKeys)("badge__requiresAction")})]})})]},e.id)},H=({account:e})=>{let{provider:t,enterpriseConnection:r}=e,o=t.replace(/(oauth_|saml_)/,"").trim(),a=r?.name??o,n={elementDescriptor:[l.descriptors.providerIcon],alt:a,sx:e=>({width:e.sizes.$4}),elementId:l.descriptors.enterpriseButtonsProviderIcon.setId(e.provider)};return r?.logoPublicUrl?(0,i.tZ)(l.Image,{...n,src:r.logoPublicUrl}):(0,i.tZ)(P.e_,{id:o,value:a,"aria-label":`${a}'s icon`,elementDescriptor:[l.descriptors.providerIcon,l.descriptors.providerInitialIcon],elementId:l.descriptors.providerInitialIcon.setId(o)})};var Y=r(207);let j=(0,s.withCardStateProvider)(e=>{let{phoneId:t,onSuccess:r,onReset:a}=e,{user:n}=(0,f.aF)(),s=o.useRef(n?.phoneNumbers.find(e=>e.id===t)),c=(0,P.a2)({defaultStep:+!!s.current});return(0,i.BX)(P.en,{...c.props,children:[(0,i.tZ)(V,{resourceRef:s,title:(0,l.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:c.nextStep,onReset:a}),(0,i.tZ)(Q,{resourceRef:s,title:(0,l.localizationKeys)("userProfile.phoneNumberPage.verifyTitle"),onSuccess:r,onReset:a})]})}),V=e=>{let{title:t,onSuccess:r,onReset:o,onUseExistingNumberClick:a,resourceRef:n}=e,c=(0,s.useCardState)(),{user:d}=(0,f.aF)(),u=(0,f.WZ)((e,t)=>e.createPhoneNumber(t)),m=(0,Z.Yp)("phoneNumber","",{type:"tel",label:(0,l.localizationKeys)("formFieldLabel__phoneNumber"),isRequired:!0}),h=m.value.length>1&&d?.username!==m.value,p=!!d?.phoneNumbers?.length&&a,P=async e=>{if(e.preventDefault(),d)return u(d,{phoneNumber:m.value}).then(e=>{n.current=e,r()}).catch(e=>(0,Z.S3)(e,[m],c.setError))};return(0,i.tZ)(s.FormContainer,{headerTitle:t,gap:1,children:(0,i.BX)(s.Form.Root,{gap:4,onSubmit:P,children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.phoneNumberPage.infoText"),colorScheme:"secondary"}),(0,i.tZ)(s.Form.ControlRow,{elementId:m.id,children:(0,i.tZ)(s.Form.PhoneInput,{...m.props,autoFocus:!0})}),(0,i.BX)(l.Flex,{justify:p?"between":"end",children:[p&&(0,i.tZ)(l.Button,{variant:"ghost",localizationKey:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.backButton"),onClick:a}),(0,i.tZ)(s.FormButtons,{submitLabel:(0,l.localizationKeys)("userProfile.formButtonPrimary__add"),isDisabled:!h,onReset:o})]})]})})},Q=e=>{let{title:t,onSuccess:r,resourceRef:o,onReset:a}=e;return(0,i.tZ)(s.FormContainer,{headerTitle:t,headerSubtitle:(0,l.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:o.current?.phoneNumber}),children:(0,i.tZ)(Y.H,{nextStep:r,identification:o.current,identifier:o.current?.phoneNumber,prepareVerification:o.current?.prepareVerification,onReset:a})})},G=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(z,{onSuccess:t,onReset:t,...e})},J=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(j,{onSuccess:t,onReset:t,...e})},ee=({shouldAllowCreation:e=!0})=>{let{user:t}=(0,f.aF)(),r=!!t?.phoneNumbers?.length;return e||r?(0,i.tZ)(s.ProfileSection.Root,{centered:!1,title:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.title"),id:"phoneNumbers",children:(0,i.tZ)(g.a.Root,{children:(0,i.BX)(s.ProfileSection.ItemList,{id:"phoneNumbers",children:[E(t?.phoneNumbers,t?.primaryPhoneNumberId).map(e=>{let r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"phoneNumbers",children:[(0,i.tZ)(l.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(l.Flex,{gap:2,center:!0,children:[(0,i.tZ)(l.Text,{sx:e=>({color:e.colors.$colorText}),children:(0,Z.L_)(e.phoneNumber)}),t?.primaryPhoneNumberId===r&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__unverified")})]})}),(0,i.tZ)(et,{phone:e})]}),(0,i.tZ)(g.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(g.a.Card,{variant:"destructive",children:(0,i.tZ)(G,{phoneId:r})})}),(0,i.tZ)(g.a.Open,{value:`verify-${r}`,children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(J,{phoneId:r})})})]},r)}),e&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(g.a.Trigger,{value:"add",children:(0,i.tZ)(s.ProfileSection.ArrowButton,{id:"phoneNumbers",localizationKey:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.primaryButton")})}),(0,i.tZ)(g.a.Open,{value:"add",children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(J,{})})})]})]})})}):null},et=({phone:e})=>{let t=(0,s.useCardState)(),{open:r}=(0,y.XC)(),{user:o}=(0,f.aF)(),a=e.id,n=(0,f.WZ)(t=>t.update({primaryPhoneNumberId:e.id}));if(!o)return null;let c=o.primaryPhoneNumberId===e.id,d="verified"===e.verification.status,u=[c&&!d?{label:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__primary"),onClick:()=>r(`verify-${a}`)}:null,!c&&d?{label:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__nonPrimary"),onClick:()=>n(o).catch(e=>(0,Z.S3)(e,[],t.setError))}:null,c||d?null:{label:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__unverified"),onClick:()=>r(`verify-${a}`)},{label:(0,l.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveAction"),isDestructive:!0,onClick:()=>r(`remove-${a}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:u})};var er=r(1201);let ei=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:o}=(0,f.aF)(),a=(0,f.WZ)(e=>o?.update({username:e})),{userSettings:c}=(0,n.useEnvironment)(),d=(0,s.useCardState)(),{t:u,locale:m}=(0,l.useLocalizations)(),{usernameSettings:h}=c,p=(0,Z.Yp)("username",o?.username||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__username"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__username"),buildErrorMessage:e=>(0,Z.fq)(e,{t:u,locale:m,usernameSettings:h})});if(!o)return null;let P=c.attributes.username?.required,g=(!P||p.value.length>0)&&o.username!==p.value,y=async()=>{try{await a(p.value),t()}catch(e){(0,Z.S3)(e,[p],d.setError)}};return(0,i.tZ)(s.FormContainer,{headerTitle:o.username?(0,l.localizationKeys)("userProfile.usernamePage.title__update"):(0,l.localizationKeys)("userProfile.usernamePage.title__set"),children:(0,i.BX)(s.Form.Root,{onSubmit:y,children:[(0,i.tZ)(s.Form.ControlRow,{elementId:p.id,children:(0,i.tZ)(s.Form.PlainInput,{...p.props,autoFocus:!0,isRequired:P})}),(0,i.tZ)(s.FormButtons,{isDisabled:!g,onReset:r})]})})}),eo=()=>{let{close:e}=(0,y.XC)();return(0,i.tZ)(ei,{onSuccess:e,onReset:e})},ea=()=>{let{user:e}=(0,f.aF)();return e?(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.usernameSection.title"),id:"username",sx:{alignItems:"center",[er.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(g.a.Root,{children:[(0,i.tZ)(g.a.Closed,{value:"edit",children:(0,i.BX)(s.ProfileSection.Item,{id:"username",sx:{paddingLeft:e.username?void 0:"0"},children:[e.username&&(0,i.tZ)(l.Text,{truncate:!0,sx:e=>({color:e.colors.$colorText}),children:e.username}),(0,i.tZ)(g.a.Trigger,{value:"edit",children:(0,i.tZ)(s.ProfileSection.Button,{id:"username",localizationKey:e.username?(0,l.localizationKeys)("userProfile.start.usernameSection.primaryButton__updateUsername"):(0,l.localizationKeys)("userProfile.start.usernameSection.primaryButton__setUsername")})})]})}),(0,i.tZ)(g.a.Open,{value:"edit",children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(eo,{})})})]})}):null},en=e=>{let{user:t,...r}=e;return(0,i.tZ)(s.AvatarUploader,{...r,title:(0,d.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,i.tZ)(s.UserAvatar,{size:e=>e.sizes.$12,...t})})},el=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,o=(0,s.useCardState)(),{user:a}=(0,f.aF)();if(!a)return null;let{first_name:c,last_name:d}=(0,n.useEnvironment)().userSettings.attributes,u=c?.enabled,m=d?.enabled,h=a.firstName||"",P=a.lastName||"",g=(0,Z.Yp)("firstName",a.firstName||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__firstName"),isRequired:d?.required}),y=(0,Z.Yp)("lastName",a.lastName||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__lastName"),isRequired:d?.required}),v=u&&g.value!==h||m&&y.value!==P,b=u&&c.required||m&&d.required,S=b&&!!y.value&&!!g.value&&v,C=a.enterpriseAccounts.some(e=>e.active),z=async e=>(e.preventDefault(),(v?a.update({firstName:g.value,lastName:y.value}):Promise.resolve()).then(t).catch(e=>{(0,Z.S3)(e,[g,y],o.setError)}));return(0,i.BX)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.profilePage.title"),children:[C&&(0,i.tZ)(s.InformationBox,{message:(0,l.localizationKeys)("userProfile.profilePage.readonly")}),(0,i.BX)(s.Form.Root,{onSubmit:z,sx:e=>({gap:e.space.$6}),children:[(0,i.tZ)(en,{user:a,onAvatarChange:e=>a.setProfileImage({file:e}).then(()=>{o.setIdle()}).catch(e=>(0,Z.S3)(e,[],o.setError)),onAvatarRemove:(0,p.QO)(a.imageUrl)?null:()=>{a.setProfileImage({file:null}).then(()=>{o.setIdle()}).catch(e=>(0,Z.S3)(e,[],o.setError))}}),(u||m)&&(0,i.BX)(s.Form.ControlRow,{elementId:"name",children:[u&&(0,i.tZ)(s.Form.PlainInput,{...g.props,isDisabled:C,autoFocus:!0}),m&&(0,i.tZ)(s.Form.PlainInput,{...y.props,isDisabled:C,autoFocus:!u})]}),(0,i.tZ)(s.FormButtons,{isDisabled:b?!S:!v,onReset:r})]})]})}),es=()=>{let{close:e}=(0,y.XC)();return(0,i.tZ)(el,{onSuccess:e,onReset:e})},ec=()=>{let{user:e}=(0,f.aF)();if(!e)return null;let{username:t,primaryEmailAddress:r,primaryPhoneNumber:o,primaryWeb3Wallet:a,...n}=e;return(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.profileSection.title"),id:"profile",sx:{[er.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(g.a.Root,{children:[(0,i.tZ)(g.a.Closed,{value:"edit",children:(0,i.BX)(s.ProfileSection.Item,{id:"profile",children:[(0,i.tZ)(s.UserPreview,{user:n,size:"lg",mainIdentifierVariant:"subtitle",sx:e=>({color:e.colors.$colorText})}),(0,i.tZ)(g.a.Trigger,{value:"edit",children:(0,i.tZ)(s.ProfileSection.Button,{id:"profile",localizationKey:(0,l.localizationKeys)("userProfile.start.profileSection.primaryButton")})})]})}),(0,i.tZ)(g.a.Open,{value:"edit",children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(es,{})})})]})})};var ed=r(4101);let eu=(0,s.withCardStateProvider)(({onClick:e})=>{let t=(0,s.useCardState)(),{user:r}=(0,f.aF)(),{strategies:o,strategyToDisplayData:a}=(0,v.vO)(),n=o.filter(e=>e.startsWith("web3")),c=r?.verifiedWeb3Wallets.map(e=>e.verification.strategy),d=n.filter(e=>!c.includes(e)),u=(0,f.WZ)(e=>r?.createWeb3Wallet({web3Wallet:e})),m=async e=>{let i=e.replace("web3_","").replace("_signature","");t.setError(void 0);try{t.setLoading(e);let o=await (0,ed.Ly)({provider:i});if(!r)throw Error("user is not defined");let a=await u(o);a=await a?.prepareVerification({strategy:e});let n=a?.verification.message,l=await (0,ed.bQ)({identifier:o,nonce:n,provider:i});await a?.attemptVerification({signature:l}),t.setIdle()}catch(r){t.setIdle();let e=(0,Z.zQ)(r);e?t.setError(e.longMessage):(0,Z.S3)(r,[],t.setError)}};return 0===d.length?null:(0,i.BX)(i.HY,{children:[(0,i.tZ)(s.ProfileSection.ActionMenu,{id:"web3Wallets",triggerLocalizationKey:(0,l.localizationKeys)("userProfile.start.web3WalletsSection.primaryButton"),onClick:e,children:d.map(e=>(0,i.tZ)(s.ProfileSection.ActionMenuItem,{id:a[e].id,onClick:()=>m(e),isLoading:t.loadingMetadata===e,isDisabled:t.isLoading,localizationKey:(0,l.localizationKeys)("userProfile.web3WalletPage.web3WalletButtonsBlockButton",{provider:a[e].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:(0,i.tZ)(l.Image,{elementDescriptor:l.descriptors.providerIcon,elementId:l.descriptors.providerIcon.setId(a[e].id),isLoading:t.loadingMetadata===e,isDisabled:t.isLoading,src:a[e].iconUrl,alt:`Connect ${a[e].name}`,sx:e=>({width:e.sizes.$5})})},e))}),t.error&&(0,i.tZ)(l.Text,{colorScheme:"danger",sx:e=>({padding:e.sizes.$1x5,paddingLeft:e.sizes.$8x5}),children:t.error})]})}),em=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(B,{onSuccess:t,onReset:t,...e})},eh=e=>e.length<=10?e:e.slice(0,6)+"..."+e.slice(-4),ef=(0,s.withCardStateProvider)(({shouldAllowCreation:e=!0})=>{let{user:t}=(0,f.aF)(),r=(0,s.useCardState)(),{strategyToDisplayData:a}=(0,v.vO)(),n=!!t?.web3Wallets?.length,[c,d]=(0,o.useState)(null);return e||n?(0,i.BX)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.web3WalletsSection.title"),centered:!1,id:"web3Wallets",children:[(0,i.tZ)(s.Card.Alert,{children:r.error}),(0,i.BX)(g.a.Root,{value:c,onChange:d,children:[(0,i.tZ)(s.ProfileSection.ItemList,{id:"web3Wallets",children:E(t?.web3Wallets,t?.primaryWeb3WalletId).map(e=>{let r=e.verification.strategy,n=e.id;return a[r]&&(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"web3Wallets",align:"start",children:[(0,i.BX)(l.Flex,{sx:e=>({alignItems:"center",gap:e.space.$2,width:"100%"}),children:[a[r].iconUrl&&(0,i.tZ)(l.Image,{src:a[r].iconUrl,alt:a[r].name,sx:e=>({width:e.sizes.$4})}),(0,i.tZ)(l.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,i.BX)(l.Flex,{gap:2,justify:"start",children:[(0,i.BX)(l.Text,{children:[a[r].name," (",eh(e.web3Wallet),")"]}),t?.primaryWeb3WalletId===n&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__unverified")})]})})]}),(0,i.tZ)(ep,{walletId:n})]},n),(0,i.tZ)(g.a.Open,{value:`remove-${n}`,children:(0,i.tZ)(g.a.Card,{variant:"destructive",children:(0,i.tZ)(em,{walletId:e.id})})})]},e.id)})}),e&&(0,i.tZ)(eu,{onClick:()=>d(null)})]})]}):null}),ep=({walletId:e})=>{let t=(0,s.useCardState)(),{open:r}=(0,y.XC)(),{user:o}=(0,f.aF)(),a=o?.primaryWeb3WalletId===e,n=(0,f.WZ)(()=>o?.update({primaryWeb3WalletId:e})),c=[a?null:{label:(0,l.localizationKeys)("userProfile.start.web3WalletsSection.detailsAction__nonPrimary"),onClick:()=>{n().catch(e=>(0,Z.S3)(e,[],t.setError))}},{label:(0,l.localizationKeys)("userProfile.start.web3WalletsSection.destructiveAction"),isDestructive:!0,onClick:()=>r(`remove-${e}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:c})},eP=(0,s.withCardStateProvider)(()=>{let{attributes:e,social:t,enterpriseSSO:r}=(0,n.useEnvironment)().userSettings,o=(0,s.useCardState)(),{user:a}=(0,f.aF)(),c=e.username?.enabled,d=e.email_address?.enabled,u=e.phone_number?.enabled,m=t&&Object.values(t).filter(e=>e.enabled).length>0,h=a&&r.enabled,p=e.web3_wallet?.enabled,P=!h||!a.enterpriseAccounts.some(e=>e.active&&e.enterpriseConnection?.disableAdditionalIdentifications);return(0,i.tZ)(l.Col,{elementDescriptor:l.descriptors.page,sx:e=>({gap:e.space.$8,color:e.colors.$colorText}),children:(0,i.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("account"),children:[(0,i.tZ)(s.Header.Root,{children:(0,i.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("userProfile.start.headerTitle__account"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,i.tZ)(s.Card.Alert,{children:o.error}),(0,i.tZ)(ec,{}),c&&(0,i.tZ)(ea,{}),d&&(0,i.tZ)(W,{shouldAllowCreation:P}),u&&(0,i.tZ)(ee,{shouldAllowCreation:P}),m&&(0,i.tZ)(k,{shouldAllowCreation:P}),h&&(0,i.tZ)(U,{}),p&&(0,i.tZ)(ef,{shouldAllowCreation:P})]})})});var eg=r(5006);let ey=()=>{let{navigate:e}=(0,c.useRouter)();return(0,i.BX)(i.HY,{children:[(0,i.tZ)(s.Header.Root,{sx:e=>({borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,marginBlockEnd:e.space.$4,paddingBlockEnd:e.space.$4}),children:(0,i.tZ)(s.Header.BackLink,{onClick:()=>void e("../",{searchParams:new URLSearchParams("tab=plans")}),children:(0,i.tZ)(s.Header.Title,{localizationKey:(0,d.u1)("userProfile.plansPage.title"),textVariant:"h2"})})}),(0,i.tZ)(n.PricingTableContext.Provider,{value:{componentName:"PricingTable",mode:"modal"},children:(0,i.tZ)(eg.b,{})})]})},ev=()=>(0,i.tZ)(n.SubscriberTypeContext.Provider,{value:"user",children:(0,i.tZ)(ey,{})});var eZ=r(3610);let eb=()=>{let{user:e}=(0,f.aF)(),{session:t}=(0,f.kP)(),{data:r,isLoading:o}=(0,v.ib)(e?.getSessions,"user-sessions");return(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.activeDevicesSection.title"),centered:!1,id:"activeDevices",children:(0,i.tZ)(s.ProfileSection.ItemList,{id:"activeDevices",disableAnimation:!0,children:o?(0,i.tZ)(s.FullHeightLoader,{}):r?.sort(A(t.id)).map(e=>eS(e.status)?i.tZ(eC,{session:e},e.id):null)})})},eS=e=>["active","pending"].includes(e),eC=({session:e})=>{let t=f.kP().session?.id===e.id,r=(0,v._m)(),o=(0,f.WZ)(e.revoke.bind(e)),a=async()=>{if(!t&&e)return r.setLoading(),o().catch(e=>(0,Z.S3)(e,[],r.setError)).finally(()=>r.setIdle())};return(0,i.tZ)(s.ProfileSection.Item,{id:"activeDevices",elementDescriptor:l.descriptors.activeDeviceListItem,elementId:t?l.descriptors.activeDeviceListItem.setId("current"):void 0,sx:{alignItems:"flex-start",opacity:r.isLoading?.5:1},isDisabled:r.isLoading,children:(0,i.BX)(i.HY,{children:[(0,i.tZ)(ez,{session:e}),!t&&(0,i.tZ)(eK,{revoke:a})]})})},ez=e=>{let{session:t}=(0,f.kP)(),r=t?.id===e.session.id,o=!!t?.actor,a=!!e.session.actor,{city:n,country:s,browserName:c,browserVersion:d,deviceType:u,ipAddress:m,isMobile:h}=e.session.latestActivity,p=`${c||""} ${d||""}`.trim()||"Web browser",P=[n||"",s||""].filter(Boolean).join(", ").trim()||null,{t:g}=(0,l.useLocalizations)();return(0,i.BX)(l.Flex,{elementDescriptor:l.descriptors.activeDevice,elementId:r?l.descriptors.activeDevice.setId("current"):void 0,sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[er.mqu.sm]:{gap:e.space.$2}}),children:[(0,i.tZ)(l.Flex,{sx:e=>({[er.mqu.sm]:{padding:"0"},borderRadius:e.radii.$md}),children:(0,i.tZ)(l.Icon,{elementDescriptor:l.descriptors.activeDeviceIcon,elementId:l.descriptors.activeDeviceIcon.setId(h?"mobile":"desktop"),icon:h?eZ.Fh:eZ.eu,sx:e=>({"--cl-chassis-bottom":"#444444","--cl-chassis-back":"#343434","--cl-chassis-screen":"#575757","--cl-screen":"#000000",width:e.space.$8,height:e.space.$8})})}),(0,i.BX)(l.Col,{align:"start",gap:1,children:[(0,i.BX)(l.Flex,{center:!0,gap:2,children:[(0,i.tZ)(l.Text,{children:u||(h?"Mobile device":"Desktop device")}),r&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__thisDevice"),colorScheme:o?"danger":"primary"}),o&&!a&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__userDevice")}),!r&&a&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__otherImpersonatorDevice"),colorScheme:"danger"})]}),(0,i.tZ)(l.Text,{colorScheme:"secondary",children:p}),(0,i.BX)(l.Text,{colorScheme:"secondary",children:[m," (",P,")"]}),(0,i.tZ)(l.Text,{colorScheme:"secondary",children:g((0,Z.Qg)(e.session.lastActiveAt))})]})]})},eK=({revoke:e})=>{let t=[{label:(0,l.localizationKeys)("userProfile.start.activeDevicesSection.destructiveAction"),isDestructive:!0,onClick:e}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:t})};var eB=r(4264);let ex=(0,s.withCardStateProvider)(e=>{let{onReset:t}=e,r=(0,s.useCardState)(),{afterSignOutUrl:o,afterMultiSessionSingleSignOutUrl:a}=(0,n.useSignOutContext)(),{user:c}=(0,f.aF)(),{t:d}=(0,l.useLocalizations)(),{otherSessions:u}=(0,eB.j)({user:c}),{setActive:m}=(0,f.cL)(),h=(0,f.WZ)(()=>c?.delete()),p=(0,Z.Yp)("deleteConfirmation","",{type:"text",label:(0,l.localizationKeys)("userProfile.deletePage.actionDescription"),isRequired:!0,placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount")}),P=p.value===(d((0,l.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount"))||"Delete account"),g=async()=>{if(P)try{await h();let e=0===u.length?o:a;return await m({session:null,redirectUrl:e})}catch(e){(0,Z.S3)(e,[],r.setError)}};return(0,i.tZ)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.deletePage.title"),sx:e=>({gap:e.space.$0x5}),children:(0,i.BX)(s.Form.Root,{onSubmit:g,children:[(0,i.BX)(l.Col,{gap:1,children:[(0,i.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("userProfile.deletePage.messageLine1")}),(0,i.tZ)(l.Text,{colorScheme:"danger",localizationKey:(0,l.localizationKeys)("userProfile.deletePage.messageLine2")})]}),(0,i.tZ)(s.Form.ControlRow,{elementId:p.id,children:(0,i.tZ)(s.Form.PlainInput,{...p.props,ignorePasswordManager:!0})}),(0,i.tZ)(s.FormButtons,{submitLabel:(0,l.localizationKeys)("userProfile.deletePage.confirm"),colorScheme:"danger",isDisabled:!P,onReset:t})]})})}),e_=()=>{let{close:e}=(0,y.XC)();return(0,i.tZ)(ex,{onSuccess:e,onReset:e})},eR=()=>(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.dangerSection.title"),id:"danger",sx:{alignItems:"center",[er.mqu.md]:{alignItems:"flex-start"}},children:(0,i.BX)(g.a.Root,{children:[(0,i.tZ)(g.a.Closed,{value:"delete",children:(0,i.tZ)(s.ProfileSection.Item,{id:"danger",sx:e=>({paddingLeft:e.space.$1}),children:(0,i.tZ)(g.a.Trigger,{value:"delete",children:(0,i.tZ)(s.ProfileSection.Button,{id:"danger",variant:"ghost",colorScheme:"danger",localizationKey:(0,l.localizationKeys)("userProfile.start.dangerSection.deleteAccountButton")})})})}),(0,i.tZ)(g.a.Open,{value:"delete",children:(0,i.tZ)(g.a.Card,{variant:"destructive",children:(0,i.tZ)(e_,{})})})]})});var ew=r(3531),eF=r(5878);let ek=e=>{let{code:t}=e;return(0,i.tZ)(l.Flex,{center:!0,sx:e=>({padding:`${e.space.$1} ${e.space.$4}`}),children:(0,i.tZ)(l.Text,{children:t})})},eT=e=>{let{subtitle:t,backupCodes:r}=e,{applicationName:o}=(0,n.useEnvironment)().displayConfig,{user:a}=(0,f.aF)(),{print:s,printableProps:c}=(0,P.Qz)(),{onCopy:d,hasCopied:u}=(0,v.VP)(r?.join(",")||"");if(!a)return null;let m=(0,eF.xC)(a);return r?(0,i.BX)(i.HY,{children:[(0,i.BX)(l.Col,{gap:1,children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.backupCodePage.title__codelist"),variant:"subtitle"}),(0,i.tZ)(l.Text,{localizationKey:t,variant:"caption",colorScheme:"secondary"})]}),(0,i.BX)(l.Box,{sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg}),children:[(0,i.tZ)(l.Grid,{gap:2,sx:e=>({gridTemplateColumns:`repeat(2, minmax(${e.sizes.$12}, 1fr))`,padding:`${e.space.$4} ${e.space.$6}`}),children:r.map((e,t)=>(0,i.tZ)(ek,{code:e},t))}),(0,i.BX)(l.Grid,{sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,gridTemplateColumns:"repeat(3, minmax(0, 1fr))",">:not([hidden])~:not([hidden])":{borderRightWidth:"0px",borderLeftWidth:"1px",borderStyle:"solid",borderColor:e.colors.$neutralAlpha100},">:first-child":{borderBottomLeftRadius:e.radii.$lg},">:last-child":{borderBottomRightRadius:e.radii.$lg}}),children:[(0,i.tZ)(l.Button,{variant:"ghost",sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),onClick:()=>{let e=document.createElement("a"),t=new Blob([function(e,t,r){let i=e?.join("\n");return`These are your backup codes for ${t} account ${r}.
Store them securely and keep them secret. Each code can only be used once.

${i}`}(r,o,m)],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download=`${o}_backup_codes.txt`,document.body.appendChild(e),e.click()},children:(0,i.tZ)(l.Icon,{icon:eZ.UW})}),(0,i.tZ)(l.Button,{variant:"ghost",sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),onClick:s,children:(0,i.tZ)(l.Icon,{icon:eZ.Kh})}),(0,i.tZ)(l.Button,{variant:"ghost",onClick:d,sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),children:(0,i.tZ)(l.Icon,{icon:u?eZ.Jr:eZ.CK})})]})]}),(0,i.BX)(P.o4,{...c,children:[(0,i.BX)(l.Heading,{children:["Your backup codes for ",o," account ",m,":"]}),(0,i.tZ)(l.Col,{gap:2,children:r.map((e,t)=>(0,i.tZ)(ek,{code:e},t))})]})]}):null},eI=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:a}=(0,f.aF)(),n=(0,s.useCardState)(),c=(0,f.WZ)(()=>a?.createBackupCode()),[d,u]=o.useState(void 0);return(o.useEffect(()=>{!d&&a&&c().then(e=>u(e)).catch(e=>{if((0,ew.mh)(e))return r();(0,Z.S3)(e,[],n.setError)})},[]),n.error)?(0,i.tZ)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.backupCodePage.title")}):(0,i.tZ)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.backupCodePage.title"),children:d?(0,i.BX)(i.HY,{children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.backupCodePage.successMessage")}),(0,i.tZ)(eT,{subtitle:(0,l.localizationKeys)("userProfile.backupCodePage.subtitle__codelist"),backupCodes:d.codes}),(0,i.tZ)(s.FormButtonContainer,{children:(0,i.tZ)(l.Button,{autoFocus:!0,onClick:t,localizationKey:(0,l.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:l.descriptors.formButtonPrimary})})]}):(0,i.tZ)(s.FullHeightLoader,{})})}),eA=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,o=(0,P.a2)();return(0,i.BX)(P.en,{...o.props,children:[(0,i.tZ)(eX,{onContinue:o.nextStep}),(0,i.tZ)(eI,{onSuccess:t,onReset:r})]})}),eX=e=>{let{onContinue:t}=e,{close:r}=(0,y.XC)();return(0,i.BX)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.backupCodePage.title"),children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.backupCodePage.infoText1")}),(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.backupCodePage.infoText2")}),(0,i.BX)(s.FormButtonContainer,{sx:{marginTop:0},children:[(0,i.tZ)(l.Button,{textVariant:"buttonSmall",onClick:t,localizationKey:(0,l.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:l.descriptors.formButtonPrimary}),(0,i.tZ)(l.Button,{variant:"ghost",onClick:r,localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:l.descriptors.formButtonReset})]})]})},eL=(0,s.withCardStateProvider)(e=>{let{onReset:t,onSuccess:r}=e,a=o.useRef(),c=(0,P.a2)({defaultStep:2}),d=n.useEnvironment().userSettings.attributes.backup_code?.enabled;return(0,i.BX)(P.en,{...c.props,children:[(0,i.tZ)(V,{title:(0,l.localizationKeys)("userProfile.phoneNumberPage.title"),resourceRef:a,onSuccess:c.nextStep,onUseExistingNumberClick:()=>c.goToStep(2),onReset:t}),(0,i.tZ)(eE,{title:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:a,onSuccess:()=>d?c.goToStep(3):r(),onReset:()=>c.goToStep(2)}),(0,i.tZ)(eD,{onSuccess:d?c.nextStep:r,onReset:t,onAddPhoneClick:()=>c.goToStep(0),onUnverifiedPhoneClick:e=>{a.current=e,c.goToStep(1)},title:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:a}),d&&(0,i.tZ)(s.SuccessPage,{title:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.successTitle"),text:a.current?.backupCodes&&a.current?.backupCodes.length>0?[(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1"),(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage2")]:[(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1")],onFinish:t,contents:(0,i.tZ)(eT,{backupCodes:a.current?.backupCodes})})]})}),e$=e=>{let{phone:t,onSuccess:r,onUnverifiedPhoneClick:o,resourceRef:a}=e,n=(0,s.useCardState)(),c=(0,f.WZ)(()=>t.setReservedForSecondFactor({reserved:!0})),{country:d}=(0,Z.Z_)(t.phoneNumber),u=(0,Z.L_)(t.phoneNumber),m=async()=>{if("verified"!==t.verification.status)return o(t);n.setLoading(t.id);try{await c(),a.current=t,r()}catch(e){(0,Z.S3)(e,[],n.setError)}finally{n.setIdle()}};return(0,i.BX)(l.Button,{variant:"outline",colorScheme:"neutral",sx:{justifyContent:"start"},onClick:m,isLoading:n.loadingMetadata===t.id,isDisabled:n.isLoading,children:[d.iso.toUpperCase()," ",u]},t.id)},eE=e=>{let{title:t,onSuccess:r,resourceRef:o,onReset:a}=e,n=(0,s.useCardState)(),c=o.current,d=(0,f.WZ)(()=>c?.setReservedForSecondFactor({reserved:!0})),u=async()=>{n.setLoading(c?.id);try{await d(),o.current=c,r()}catch(e){(0,Z.S3)(e,[],n.setError)}finally{n.setIdle()}};return(0,i.tZ)(s.FormContainer,{headerTitle:t,headerSubtitle:(0,l.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:o.current?.phoneNumber}),children:(0,i.tZ)(Y.H,{nextStep:()=>{u()},identification:o.current,identifier:o.current?.phoneNumber,prepareVerification:o.current?.prepareVerification,onReset:a})})},eD=e=>{let{onSuccess:t,onReset:r,title:o,onAddPhoneClick:a,onUnverifiedPhoneClick:n,resourceRef:c}=e,{user:d}=(0,f.aF)();if(!d)return null;let u=d.phoneNumbers.filter(e=>!e.reservedForSecondFactor);return(0,i.BX)(s.FormContainer,{headerTitle:o,gap:1,children:[(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)(u.length?"userProfile.mfaPhoneCodePage.subtitle__availablePhoneNumbers":"userProfile.mfaPhoneCodePage.subtitle__unavailablePhoneNumbers"),colorScheme:"secondary"}),u.length>0&&(0,i.tZ)(l.Col,{gap:2,children:u.map(e=>(0,i.tZ)(e$,{onSuccess:t,phone:e,onUnverifiedPhoneClick:n,resourceRef:c},e.id))}),(0,i.BX)(s.FormButtonContainer,{sx:{flexDirection:"row",justifyContent:"space-between"},children:[(0,i.tZ)(s.IconButton,{variant:"ghost","aria-label":"Add phone number",icon:(0,i.tZ)(l.Icon,{icon:eZ.v3,sx:e=>({marginRight:e.space.$2})}),localizationKey:(0,l.localizationKeys)("userProfile.mfaPhoneCodePage.primaryButton__addPhoneNumber"),onClick:a}),(0,i.tZ)(l.Button,{variant:"ghost",localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),onClick:r})]})]})},eN=(0,s.withCardStateProvider)(e=>{let{title:t,onSuccess:r,onReset:a}=e,{user:n}=(0,f.aF)(),c=(0,s.useCardState)(),d=(0,f.WZ)(()=>n?.createTOTP()),{close:u}=(0,y.XC)(),[m,h]=o.useState(void 0),[p,g]=o.useState("qr");return(o.useEffect(()=>{n&&d().then(e=>h(e)).catch(e=>(0,ew.uX)(e)&&"reverification_cancelled"===e.code?u():(0,Z.S3)(e,[],c.setError))},[]),c.error)?(0,i.tZ)(s.FormContainer,{headerTitle:t}):(0,i.BX)(s.FormContainer,{headerTitle:t,headerSubtitle:"qr"==p?(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__ableToScan"):(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__unableToScan"),children:[!m&&(0,i.tZ)(s.FullHeightLoader,{}),m&&(0,i.BX)(i.HY,{children:[(0,i.BX)(l.Col,{gap:4,children:["qr"==p&&(0,i.tZ)(P.s_,{justify:"center",url:m.uri||""}),"uri"==p&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan1")}),(0,i.tZ)(s.ClipboardInput,{value:m.secret}),(0,i.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan2")}),(0,i.tZ)(s.ClipboardInput,{value:m.uri})]})]}),(0,i.BX)(l.Flex,{justify:"between",align:"center",sx:{width:"100%"},children:["qr"==p&&(0,i.tZ)(l.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>g("uri"),localizationKey:(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonUnableToScan__nonPrimary")}),"uri"==p&&(0,i.tZ)(l.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>g("qr"),localizationKey:(0,l.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonAbleToScan__nonPrimary")}),(0,i.BX)(s.FormButtonContainer,{children:[(0,i.tZ)(l.Button,{onClick:r,localizationKey:(0,l.localizationKeys)("userProfile.formButtonPrimary__continue"),elementDescriptor:l.descriptors.formButtonPrimary}),(0,i.tZ)(l.Button,{variant:"ghost",onClick:a,localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:l.descriptors.formButtonReset})]})]})]})]})}),eO=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,resourceRef:o}=e,{user:a}=(0,f.aF)(),n=(0,s.useFieldOTP)({onCodeEntryFinished:(e,t,r)=>{a?.verifyTOTP({code:e}).then(e=>t(e)).catch(r)},onResolve:e=>{o.current=e,t()}});return(0,i.BX)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.mfaTOTPPage.title"),children:[(0,i.tZ)(l.Col,{children:(0,i.tZ)(s.Form.OTPInput,{...n,label:(0,l.localizationKeys)("userProfile.mfaTOTPPage.verifyTitle"),description:(0,l.localizationKeys)("userProfile.mfaTOTPPage.verifySubtitle")})}),(0,i.tZ)(s.FormButtonContainer,{sx:{marginTop:0},children:(0,i.tZ)(l.Button,{onClick:r,variant:"ghost",isDisabled:n.isLoading,localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:l.descriptors.formButtonReset})})]})}),eW=(0,s.withCardStateProvider)(e=>{let{onReset:t}=e,r=(0,P.a2)(),a=o.useRef();return(0,i.BX)(P.en,{...r.props,children:[(0,i.tZ)(eN,{title:(0,l.localizationKeys)("userProfile.mfaTOTPPage.title"),onSuccess:r.nextStep,onReset:t}),(0,i.tZ)(eO,{onSuccess:r.nextStep,onReset:t,resourceRef:a}),(0,i.tZ)(s.SuccessPage,{title:(0,l.localizationKeys)("userProfile.mfaTOTPPage.title"),text:(0,l.localizationKeys)("userProfile.mfaTOTPPage.successMessage"),onFinish:t,contents:(0,i.tZ)(eT,{subtitle:(0,l.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:a.current?.backupCodes})})]})}),eM=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,selectedStrategy:a}=e,c=(0,s.useCardState)(),{userSettings:{attributes:d}}=(0,n.useEnvironment)(),{user:u}=(0,f.aF)();if(!u)return null;let m=(0,l.localizationKeys)("userProfile.mfaPage.title"),h=o.useMemo(()=>$(d,u),[]);return(o.useEffect(()=>{0===h.length&&c.setError("There are no second factors available to add")},[]),c.error)?(0,i.tZ)(s.FormContainer,{headerTitle:m}):0!==h.length||a?(0,i.tZ)(eU,{onSuccess:t,onReset:r,method:a||h[0]}):null}),eU=e=>{let{method:t,onSuccess:r,onReset:o}=e;switch(t){case"phone_code":return(0,i.tZ)(eL,{onSuccess:r,onReset:o});case"totp":return(0,i.tZ)(eW,{onSuccess:r,onReset:o});case"backup_code":return(0,i.tZ)(eA,{onSuccess:r,onReset:o});default:return null}},eq=()=>{let{close:e}=(0,y.XC)();return(0,i.tZ)(_,{onSuccess:e,onReset:e})},eH=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(x,{onSuccess:t,onReset:t,...e})},eY=()=>{let{close:e}=(0,y.XC)();return(0,i.tZ)(eI,{onSuccess:e,onReset:e})},ej=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(eM,{onSuccess:t,onReset:t,selectedStrategy:e.selectedStrategy})},eV=()=>{let{userSettings:{attributes:e}}=(0,n.useEnvironment)(),{user:t}=(0,f.aF)(),[r,a]=(0,o.useState)(null);if(!t)return null;let c=L(e),d=$(e,t),u=c.includes("totp")&&t.totpEnabled,m=c.includes("backup_code")&&t.backupCodeEnabled,h=t.phoneNumbers.filter(e=>"verified"===e.verification.status).filter(e=>e.reservedForSecondFactor).sort(X);return(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.mfaSection.title"),centered:!1,id:"mfa",children:(0,i.tZ)(g.a.Root,{value:r,onChange:a,children:(0,i.BX)(s.ProfileSection.ItemList,{id:"mfa",children:[u&&(0,i.BX)(i.HY,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(l.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(l.Icon,{icon:eZ.hc,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.start.mfaSection.totp.headerTitle")}),(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__default")})]}),(0,i.tZ)(eJ,{})]}),(0,i.tZ)(g.a.Open,{value:"remove-totp",children:(0,i.tZ)(g.a.Card,{variant:"destructive",children:(0,i.tZ)(eq,{})})})]}),c.includes("phone_code")&&h.map(e=>{let t=!u&&e.defaultSecondFactor,r=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(l.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(l.Icon,{icon:eZ.ij,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.BX)(l.Text,{children:["SMS Code ",(0,i.tZ)(s.FormattedPhoneNumberText,{value:e.phoneNumber})]}),t&&(0,i.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__default")})]}),(0,i.tZ)(eQ,{phone:e,showTOTP:u})]}),(0,i.tZ)(g.a.Open,{value:`remove-${r}`,children:(0,i.tZ)(g.a.Card,{variant:"destructive",children:(0,i.tZ)(eH,{phoneId:r})})})]},r)}),m&&(0,i.BX)(i.HY,{children:[(0,i.BX)(s.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,i.BX)(l.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,i.tZ)(l.Icon,{icon:eZ.Qi,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,i.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("userProfile.start.mfaSection.backupCodes.headerTitle")})]}),(0,i.tZ)(eG,{})]}),(0,i.tZ)(g.a.Open,{value:"regenerate",children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(eY,{})})})]}),(0,i.tZ)(e0,{secondFactorsAvailableToAdd:d,onClick:()=>a(null)})]})})})},eQ=({phone:e,showTOTP:t})=>{let{open:r}=(0,y.XC)(),o=(0,s.useCardState)(),a=e.id,n=[t||e.defaultSecondFactor?null:{label:(0,l.localizationKeys)("userProfile.start.mfaSection.phoneCode.actionLabel__setDefault"),onClick:()=>e.makeDefaultSecondFactor().catch(e=>(0,Z.S3)(e,[],o.setError))},{label:(0,l.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionLabel"),isDestructive:!0,onClick:()=>r(`remove-${a}`)}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:n})},eG=()=>{let{open:e}=(0,y.XC)(),t=[{label:(0,l.localizationKeys)("userProfile.start.mfaSection.backupCodes.actionLabel__regenerate"),onClick:()=>e("regenerate")}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:t})},eJ=()=>{let{open:e}=(0,y.XC)(),t=[{label:(0,l.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionTitle"),isDestructive:!0,onClick:()=>e("remove-totp")}].filter(e=>null!==e);return(0,i.tZ)(s.ThreeDotsMenu,{actions:t})},e0=e=>{let{open:t}=(0,y.XC)(),{secondFactorsAvailableToAdd:r,onClick:a}=e,[n,c]=(0,o.useState)(),d=o.useMemo(()=>r.map(e=>"phone_code"===e?{icon:eZ.ij,text:"SMS code",key:"phone_code"}:"totp"===e?{icon:eZ.hc,text:"Authenticator application",key:"totp"}:"backup_code"===e?{icon:eZ.Qi,text:"Backup code",key:"backup_code"}:null).filter(e=>null!==e),[r]);return(0,i.BX)(i.HY,{children:[r.length>0&&(0,i.tZ)(g.a.Closed,{value:"multi-factor",children:(0,i.tZ)(s.ProfileSection.ActionMenu,{id:"mfa",triggerLocalizationKey:(0,l.localizationKeys)("userProfile.start.mfaSection.primaryButton"),onClick:a,children:d.map(e=>e&&(0,i.tZ)(s.ProfileSection.ActionMenuItem,{id:e.key,localizationKey:e.text,leftIcon:e.icon,onClick:()=>{c(e.key),t("multi-factor")}},e.key))})}),(0,i.tZ)(g.a.Open,{value:"multi-factor",children:(0,i.tZ)(g.a.Card,{children:n&&(0,i.tZ)(ej,{selectedStrategy:n})})})]})},e1=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(R,{onSuccess:t,onReset:t,...e})},e3=e=>{let{close:t}=(0,y.XC)();return(0,i.tZ)(e2,{onSuccess:t,onReset:t,passkey:e.passkey})},e2=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r,passkey:o}=e,a=(0,s.useCardState)(),n=(0,Z.Yp)("passkeyName",o.name||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__passkeyName"),isRequired:!0}),c=n.value.length>1&&o.name!==n.value,d=async e=>(e.preventDefault(),o.update({name:n.value}).then(t).catch(e=>(0,Z.S3)(e,[n],a.setError)));return(0,i.tZ)(s.FormContainer,{headerTitle:(0,l.localizationKeys)("userProfile.passkeyScreen.title__rename"),headerSubtitle:(0,l.localizationKeys)("userProfile.passkeyScreen.subtitle__rename"),children:(0,i.BX)(s.Form.Root,{onSubmit:d,children:[(0,i.tZ)(s.Form.ControlRow,{elementId:n.id,children:(0,i.tZ)(s.Form.PlainInput,{...n.props,autoComplete:"off"})}),(0,i.tZ)(s.FormButtons,{submitLabel:(0,l.localizationKeys)("userProfile.formButtonPrimary__save"),isDisabled:!c,onReset:r})]})})}),e4=()=>{let{user:e}=(0,f.aF)(),[t,r]=(0,o.useState)(null);return e?(0,i.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("userProfile.start.passkeysSection.title"),centered:!1,id:"passkeys",children:(0,i.tZ)(g.a.Root,{value:t,onChange:r,children:(0,i.BX)(s.ProfileSection.ItemList,{id:"passkeys",children:[e.passkeys.map(e=>{let t=e.id;return(0,i.BX)(o.Fragment,{children:[(0,i.tZ)(e7,{...e},t),(0,i.tZ)(g.a.Open,{value:`remove-${t}`,children:(0,i.tZ)(g.a.Card,{variant:"destructive",children:(0,i.tZ)(e1,{passkey:e})})}),(0,i.tZ)(g.a.Open,{value:`rename-${t}`,children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(e3,{passkey:e})})})]},t)}),(0,i.tZ)(e5,{onClick:()=>r(null)})]})})}):null},e7=e=>(0,i.BX)(s.ProfileSection.Item,{id:"passkeys",hoverable:!0,sx:{alignItems:"flex-start"},children:[(0,i.tZ)(e8,{...e}),(0,i.tZ)(e6,{passkey:e})]}),e8=e=>{let{name:t,createdAt:r,lastUsedAt:o}=e,{t:a}=(0,l.useLocalizations)();return(0,i.tZ)(l.Flex,{sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[er.mqu.sm]:{gap:e.space.$2}}),children:(0,i.BX)(l.Col,{align:"start",gap:1,children:[(0,i.tZ)(l.Text,{children:t}),(0,i.BX)(l.Text,{colorScheme:"secondary",children:["Created: ",a((0,Z.Qg)(r))]}),o&&(0,i.BX)(l.Text,{colorScheme:"secondary",children:["Last used: ",a((0,Z.Qg)(o))]})]})})},e6=({passkey:e})=>{let{open:t}=(0,y.XC)(),r=e.id,o=[{label:(0,l.localizationKeys)("userProfile.start.passkeysSection.menuAction__rename"),onClick:()=>t(`rename-${r}`)},{label:(0,l.localizationKeys)("userProfile.start.passkeysSection.menuAction__destructive"),isDestructive:!0,onClick:()=>t(`remove-${r}`)}];return(0,i.tZ)(s.ThreeDotsMenu,{actions:o})},e5=({onClick:e})=>{let t=(0,s.useCardState)(),{isSatellite:r}=(0,f.cL)(),{user:o}=(0,f.aF)(),a=(0,f.WZ)(()=>o?.createPasskey()),n=async()=>{if(e?.(),o)try{await a()}catch(e){(0,Z.S3)(e,[],t.setError)}};return r?null:(0,i.tZ)(s.ProfileSection.ArrowButton,{id:"passkeys",localizationKey:(0,l.localizationKeys)("userProfile.start.passkeysSection.primaryButton"),onClick:n})},e9=(e,t)=>{let r=[];return e?r.push((0,l.localizationKeys)("userProfile.passwordPage.successMessage__update")):r.push((0,l.localizationKeys)("userProfile.passwordPage.successMessage__set")),t&&r.push((0,l.localizationKeys)("userProfile.passwordPage.successMessage__signOutOfOtherSessions")),r},te=(0,s.withCardStateProvider)(e=>{let{onSuccess:t,onReset:r}=e,{user:a}=(0,f.aF)(),c=(0,f.WZ)((e,t)=>e.updatePassword(...t));if(!a)return null;let{userSettings:{passwordSettings:d},authConfig:{reverification:u}}=(0,n.useEnvironment)(),{session:m}=(0,f.kP)(),h=a.passwordEnabled?(0,l.localizationKeys)("userProfile.passwordPage.title__update"):(0,l.localizationKeys)("userProfile.passwordPage.title__set"),p=(0,s.useCardState)(),P=a.enterpriseAccounts.some(e=>e.active),g=a.passwordEnabled&&!u,y=(0,o.useRef)({title:(0,l.localizationKeys)("userProfile.passwordPage.title__set")}),b=(0,Z.Yp)("currentPassword","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__currentPassword"),isRequired:!0}),S=(0,Z.Yp)("newPassword","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__newPassword"),isRequired:!0,validatePassword:!0,buildErrorMessage:e=>(0,Z.GM)(e,{t:x,locale:_,passwordSettings:d})}),C=(0,Z.Yp)("confirmPassword","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__confirmPassword"),isRequired:!0}),z=(0,Z.Yp)("signOutOfOtherSessions","",{type:"checkbox",label:(0,l.localizationKeys)("formFieldLabel__signOutOfOtherSessions"),defaultChecked:!0}),{setConfirmPasswordFeedback:K,isPasswordMatch:B}=(0,v.p5)({passwordField:S,confirmPasswordField:C}),{t:x,locale:_}=(0,l.useLocalizations)(),R=(g?b.value&&B:B)&&S.value&&C.value,w=async()=>{try{y.current={title:a.passwordEnabled?(0,l.localizationKeys)("userProfile.passwordPage.title__update"):(0,l.localizationKeys)("userProfile.passwordPage.title__set"),text:e9(a.passwordEnabled,!!z.checked)};let e={newPassword:S.value,signOutOfOtherSessions:z.checked,currentPassword:g?b.value:void 0};await c(a,[e]),t()}catch(e){(0,Z.S3)(e,[b,S,C],p.setError)}};return(0,i.BX)(s.FormContainer,{headerTitle:h,children:[P&&(0,i.tZ)(s.InformationBox,{message:(0,l.localizationKeys)("userProfile.passwordPage.readonly")}),(0,i.BX)(s.Form.Root,{onSubmit:w,onBlur:()=>{S.value&&K(C.value)},children:[(0,i.tZ)("input",{readOnly:!0,"data-testid":"hidden-identifier",id:"identifier-field",name:"identifier",value:m?.publicUserData.identifier||"",style:{display:"none"}}),g&&(0,i.tZ)(s.Form.ControlRow,{elementId:b.id,children:(0,i.tZ)(s.Form.PasswordInput,{...b.props,minLength:6,isRequired:!0,autoFocus:!0,isDisabled:P})}),(0,i.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,i.tZ)(s.Form.PasswordInput,{...S.props,minLength:6,isRequired:!0,autoFocus:!a.passwordEnabled,isDisabled:P})}),(0,i.tZ)(s.Form.ControlRow,{elementId:C.id,children:(0,i.tZ)(s.Form.PasswordInput,{...C.props,onChange:e=>(e.target.value&&K(e.target.value),C.props.onChange(e)),isRequired:!0,isDisabled:P})}),(0,i.tZ)(s.Form.ControlRow,{elementId:z.id,children:(0,i.tZ)(s.Form.Checkbox,{...z.props,description:(0,l.localizationKeys)("userProfile.passwordPage.checkboxInfoText__signOutOfOtherSessions"),isDisabled:P})}),P?(0,i.tZ)(s.FormButtonContainer,{children:(0,i.tZ)(s.Form.ResetButton,{localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:r})}):(0,i.tZ)(s.FormButtons,{isDisabled:!R,onReset:r})]})]})}),tt=()=>{let{close:e}=(0,y.XC)();return(0,i.tZ)(te,{onSuccess:e,onReset:e})},tr=()=>{let{user:e}=(0,f.aF)();if(!e)return null;let{passwordEnabled:t}=e;return(0,i.tZ)(s.ProfileSection.Root,{centered:!1,title:(0,l.localizationKeys)("userProfile.start.passwordSection.title"),id:"password",children:(0,i.BX)(g.a.Root,{children:[(0,i.tZ)(g.a.Closed,{value:"edit",children:(0,i.BX)(s.ProfileSection.Item,{id:"password",sx:e=>({paddingLeft:t?void 0:"0",paddingTop:e.space.$0x25,paddingBottom:e.space.$0x25}),children:[t&&(0,i.tZ)(l.Text,{variant:"h2",children:"••••••••••"}),(0,i.tZ)(g.a.Trigger,{value:"edit",children:(0,i.tZ)(s.ProfileSection.Button,{id:"password",localizationKey:t?(0,l.localizationKeys)("userProfile.start.passwordSection.primaryButton__updatePassword"):(0,l.localizationKeys)("userProfile.start.passwordSection.primaryButton__setPassword")})})]})}),(0,i.tZ)(g.a.Open,{value:"edit",children:(0,i.tZ)(g.a.Card,{children:(0,i.tZ)(tt,{})})})]})})},ti=(0,s.withCardStateProvider)(()=>{let{attributes:e,instanceIsPasswordBased:t}=(0,n.useEnvironment)().userSettings,r=(0,s.useCardState)(),{user:o}=(0,f.aF)(),a=e.passkey?.enabled,c=L(e).length>0,d=o?.deleteSelfEnabled;return(0,i.tZ)(l.Col,{elementDescriptor:l.descriptors.page,sx:e=>({gap:e.space.$8}),children:(0,i.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("security"),children:[(0,i.tZ)(s.Header.Root,{children:(0,i.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("userProfile.start.headerTitle__security"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,i.tZ)(s.Card.Alert,{children:r.error}),t&&(0,i.tZ)(tr,{}),a&&(0,i.tZ)(e4,{}),c&&(0,i.tZ)(eV,{}),(0,i.tZ)(eb,{}),d&&(0,i.tZ)(eR,{})]})})}),to=(0,o.lazy)(()=>Promise.all([r.e("507"),r.e("200"),r.e("573"),r.e("82")]).then(r.bind(r,6793)).then(e=>({default:e.BillingPage}))),ta=()=>{let{pages:e}=(0,n.useUserProfileContext)(),{commerceSettings:t}=(0,n.useEnvironment)(),r=e.routes[0].id===a.xM.ACCOUNT,l=e.routes[0].id===a.xM.SECURITY,s=e.routes[0].id===a.xM.BILLING,d=e.contents?.map((e,t)=>{let o=!r&&!l&&0===t;return i.tZ(c.Route,{index:o,path:o?void 0:e.url,children:i.tZ(m.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)});return(0,i.BX)(c.Switch,{children:[d,(0,i.BX)(c.Route,{children:[(0,i.tZ)(c.Route,{path:r?void 0:"account",children:(0,i.tZ)(c.Switch,{children:(0,i.tZ)(c.Route,{index:!0,children:(0,i.tZ)(eP,{})})})}),(0,i.tZ)(c.Route,{path:l?void 0:"security",children:(0,i.tZ)(c.Switch,{children:(0,i.tZ)(c.Route,{index:!0,children:(0,i.tZ)(ti,{})})})}),t.billing.enabled&&t.billing.hasPaidUserPlans&&(0,i.tZ)(c.Route,{path:s?void 0:"billing",children:(0,i.BX)(c.Switch,{children:[(0,i.tZ)(c.Route,{index:!0,children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(to,{})})}),(0,i.tZ)(c.Route,{path:"plans",children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(ev,{})})}),(0,i.tZ)(c.Route,{path:"statement/:statementId",children:(0,i.tZ)(o.Suspense,{fallback:"",children:(0,i.tZ)(h.j,{})})})]})})]})]})};var tn=r(2786);let tl=(0,n.withCoreUserGuard)(()=>{let e=o.useRef(null);return(0,i.tZ)(s.ProfileCard.Root,{children:(0,i.BX)(u,{contentRef:e,children:[(0,i.tZ)(s.NavbarMenuButtonRow,{navbarTitleLocalizationKey:(0,l.localizationKeys)("userProfile.navbar.title")}),(0,i.tZ)(s.ProfileCard.Content,{contentRef:e,scrollBoxId:a.g8,children:(0,i.tZ)(ta,{})})]})})}),ts=(0,s.withCardStateProvider)(e=>(0,i.tZ)(l.Flow.Root,{flow:"userProfile",children:(0,i.tZ)(l.Flow.Part,{children:(0,i.BX)(c.Switch,{children:[(0,i.tZ)(c.Route,{path:"verify",children:(0,i.tZ)(tn.M,{})}),(0,i.tZ)(c.Route,{children:(0,i.tZ)(tl,{})})]})})})),tc=e=>{let t={...e,routing:"virtual",componentName:"UserProfile",mode:"modal"};return(0,i.tZ)(c.Route,{path:"user",children:(0,i.tZ)(n.UserProfileContext.Provider,{value:t,children:(0,i.tZ)("div",{children:(0,i.tZ)(ts,{...t})})})})}}}]);