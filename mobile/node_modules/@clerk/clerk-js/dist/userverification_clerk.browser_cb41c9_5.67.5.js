"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["662"],{7389:function(e,t,r){r.d(t,{v:()=>n});var o=r(9180),i=r(3064),a=r(7718);let n=e=>{let{onBackLinkClick:t}=e;return(0,o.tZ)(a.ErrorCard,{cardTitle:(0,i.localizationKeys)("signIn.alternativeMethods.getHelp.title"),cardSubtitle:(0,i.localizationKeys)("signIn.alternativeMethods.getHelp.content"),onBackLinkClick:t})}},5518:function(e,t,r){r.d(t,{Vh:()=>f,Vs:()=>C,bx:()=>h,mQ:()=>k,s2:()=>v,t3:()=>s,xT:()=>u}),r(5027);var o=r(2208),i=r(7772),a=r(43),n=r(577);let l=e=>t=>"safeIdentifier"in t&&t.safeIdentifier===e;function c(e){if((0,o.iW)()){let t=e.find(({strategy:e})=>"passkey"===e);if(t)return t}return null}function s(e,t,r){return e&&0!==e.length?r===i.kJ.Password?function(e,t){let r=c(e);if(r)return r;let o=e.sort(n.sZ)[0];return"password"===o.strategy?o:e.find(l(t))||o||null}(e,t):function(e,t){let r=c(e);if(r)return r;let o=e.sort(n.b8),i=o.find(l(t));if(i)return i;let a=o[0];return"email_link"===a.strategy?a:e.find(l(t))||a||null}(e,t):null}let d=["passkey","email_code","password","phone_code","email_link"];function u(e){return!!e&&d.includes(e.strategy)}function h(e){if(!e||0===e.length)return null;let t=e.find(e=>"totp"===e.strategy);if(t)return t;let r=e.find(e=>"phone_code"===e.strategy);return r||e[0]}let p=["reset_password_phone_code","reset_password_email_code"],f=e=>!!e&&p.includes(e),y=e=>/^\S+@\S+\.\S+$/.test(e);function v(e){return"tel"===e.type?"phoneNumber":y(e.value)?"emailAddress":"username"}let C=(e,t,r)=>{if(!t)return null;let o=e.find(e=>"strategy"===e.id)?.value;if(o&&"phone_code"!==o)return null;let i=e.find(e=>e.id===r)?.value;if(!i||!i?.startsWith("+"))return null;let n=(0,a.jR)(i,t);return"sms"===n?null:n},k=(e,t,r)=>{if(!e||!t||"phoneNumber"!==t||!r||!r?.startsWith("+"))return null;let o=(0,a.jR)(r,e);return"sms"===o?null:o}},1419:function(e,t,r){r.r(t),r.d(t,{UserVerification:()=>Q,UserVerificationModal:()=>Y});var o=r(9180),i=r(9144),a=r(3812),n=r(3064),l=r(4676),c=r(7718),s=r(1085),d=r(5518),u=r(2672),h=r(3610),p=r(43),f=r(2208);let y=(e,t)=>!!e&&!!t&&("email_code"===e.strategy&&"email_code"===t.strategy?e.emailAddressId===t.emailAddressId:"phone_code"===e.strategy&&"phone_code"===t.strategy?e.phoneNumberId===t.phoneNumberId:e.strategy===t.strategy),v=(e,t)=>!!e&&!!t&&("phone_code"===e.strategy&&"phone_code"===t.strategy?e.phoneNumberId===t.phoneNumberId:e.strategy===t.strategy);function C({filterOutFactor:e,supportedFirstFactors:t}){let r=t?t.filter(e=>!(0,d.Vh)(e.strategy)):[],o=r&&r.length>0,a=(0,i.useMemo)(()=>t?t.filter(e=>!e.strategy.startsWith("oauth_")).filter(e=>(0,d.xT)(e)).filter(t=>!y(t,e)).filter(e=>"passkey"!==e.strategy||(0,f.iW)()).sort(p.U6):[],[t,e]);return{hasAnyStrategy:o,hasFirstParty:a&&a.length>0,firstPartyFactors:a}}var k=r(3799),m=r(2464);let b=()=>{let{level:e}=(0,a.useUserVerification)();return(0,i.useMemo)(()=>({level:e||"second_factor"}),[e])},Z=()=>{let{session:e}=(0,k.kP)(),t=b();return{...(0,m.ib)(e?e.startVerification:void 0,t,{throttleTime:300})}};function g(e){let t=t=>{let{isLoading:r,data:i}=Z();return r||!i?(0,o.tZ)(c.LoadingCard,{}):(0,o.tZ)(e,{...t})},r=e.displayName||e.name||"Component";return e.displayName=r,t.displayName=r,t}let w=e=>{let{onBackLinkClick:t}=e;return(0,o.tZ)(c.ErrorCard,{cardTitle:(0,n.localizationKeys)("reverification.alternativeMethods.getHelp.title"),cardSubtitle:(0,n.localizationKeys)("reverification.alternativeMethods.getHelp.content"),onBackLinkClick:t})},B=(e,t)=>{let[r,a]=i.useState(!1),n=i.useCallback(()=>a(e=>!e),[a]);return r?(0,o.tZ)(w,{onBackLinkClick:n}):(0,o.tZ)(e,{...t,onHavingTroubleClick:n})},F=e=>B(M,{...e}),M=e=>{let{onBackLinkClick:t,onHavingTroubleClick:r,onFactorSelected:i}=e,a=(0,u.v)(),{data:l}=Z(),{firstPartyFactors:s,hasAnyStrategy:d}=C({filterOutFactor:e?.currentFactor,supportedFirstFactors:l?.supportedFirstFactors});return(0,o.tZ)(n.Flow.Part,{part:"alternativeMethods",children:(0,o.BX)(c.Card.Root,{children:[(0,o.BX)(c.Card.Content,{children:[(0,o.BX)(c.Header.Root,{children:[(0,o.tZ)(c.Header.Title,{localizationKey:(0,n.localizationKeys)("reverification.alternativeMethods.title")}),(0,o.tZ)(c.Header.Subtitle,{localizationKey:(0,n.localizationKeys)("reverification.alternativeMethods.subtitle")})]}),(0,o.tZ)(c.Card.Alert,{children:a.error}),(0,o.tZ)(n.Flex,{direction:"col",elementDescriptor:n.descriptors.main,gap:6,children:(0,o.BX)(n.Col,{gap:4,children:[d&&(0,o.tZ)(n.Flex,{elementDescriptor:n.descriptors.alternativeMethods,direction:"col",gap:2,children:s.map((e,t)=>{var r;return(0,o.tZ)(c.ArrowBlockButton,{leftIcon:(r=e,({email_code:h.GT,phone_code:h.iU,password:h.kh,passkey:h.IG})[r.strategy]),textLocalizationKey:function(e){switch(e.strategy){case"email_code":return(0,n.localizationKeys)("reverification.alternativeMethods.blockButton__emailCode",{identifier:(0,p.HT)(e.safeIdentifier)||""});case"phone_code":return(0,n.localizationKeys)("reverification.alternativeMethods.blockButton__phoneCode",{identifier:(0,p.HT)(e.safeIdentifier)||""});case"password":return(0,n.localizationKeys)("reverification.alternativeMethods.blockButton__password");case"passkey":return(0,n.localizationKeys)("reverification.alternativeMethods.blockButton__passkey");default:throw Error(`Invalid sign in strategy: "${e.strategy}"`)}}(e),elementDescriptor:n.descriptors.alternativeMethodsBlockButton,textElementDescriptor:n.descriptors.alternativeMethodsBlockButtonText,arrowElementDescriptor:n.descriptors.alternativeMethodsBlockButtonArrow,textVariant:"buttonLarge",isDisabled:a.isLoading,onClick:()=>{a.setError(void 0),i(e)}},t)})}),t&&(0,o.tZ)(c.BackLink,{boxElementDescriptor:n.descriptors.backRow,linkElementDescriptor:n.descriptors.backLink,onClick:t})]})})]}),(0,o.tZ)(c.Card.Footer,{children:(0,o.BX)(c.Card.Action,{elementId:"havingTrouble",children:[(0,o.tZ)(c.Card.ActionText,{localizationKey:(0,n.localizationKeys)("reverification.alternativeMethods.actionText")}),(0,o.tZ)(c.Card.ActionLink,{localizationKey:(0,n.localizationKeys)("reverification.alternativeMethods.actionLink"),onClick:r})]})})]})})};var _=r(7389),A=r(4152),S=r(3234);let z=()=>{let{afterVerification:e}=(0,a.useUserVerification)(),t=(0,S.H)(),{setActive:r}=(0,k.cL)(),{setCache:o}=Z(),{navigate:n}=(0,l.useRouter)();return{handleVerificationResponse:(0,i.useCallback)(async i=>{switch(o({data:i,isLoading:!1,isValidating:!1,error:null,cachedAt:Date.now()}),i.status){case"complete":return await r({session:i.session.id}),e?.();case"needs_second_factor":return n("./factor-two");default:return console.error((0,A.Ws)(i.status,t))}},[n,r,t])}};function K(e){let{onShowAlternativeMethodsClick:t}=e,{session:r}=(0,k.kP)(),{handleVerificationResponse:a}=z(),l=(0,c.useCardState)(),[s,d]=i.useState(!1),u=i.useCallback(()=>d(e=>!e),[d]),h=(0,p.Yp)("password","",{type:"password",label:(0,n.localizationKeys)("formFieldLabel__password"),placeholder:(0,n.localizationKeys)("formFieldInputPlaceholder__password")}),f=async e=>(e.preventDefault(),r?.attemptFirstFactorVerification({strategy:"password",password:h.value}).then(a).catch(e=>p.S3(e,[h],l.setError)));return s?(0,o.tZ)(_.v,{onBackLinkClick:u}):(0,o.tZ)(n.Flow.Part,{part:"password",children:(0,o.BX)(c.Card.Root,{children:[(0,o.BX)(c.Card.Content,{children:[(0,o.BX)(c.Header.Root,{showLogo:!0,children:[(0,o.tZ)(c.Header.Title,{localizationKey:(0,n.localizationKeys)("reverification.password.title")}),(0,o.tZ)(c.Header.Subtitle,{localizationKey:(0,n.localizationKeys)("reverification.password.subtitle")})]}),(0,o.tZ)(c.Card.Alert,{children:l.error}),(0,o.BX)(n.Col,{elementDescriptor:n.descriptors.main,gap:4,children:[(0,o.BX)(c.Form.Root,{onSubmit:f,gap:8,children:[(0,o.tZ)(c.Form.ControlRow,{elementId:h.id,children:(0,o.tZ)(c.Form.PasswordInput,{...h.props,autoFocus:!0})}),(0,o.tZ)(c.Form.SubmitButton,{hasArrow:!0})]}),(0,o.tZ)(c.Card.Action,{elementId:t?"alternativeMethods":"havingTrouble",children:(0,o.tZ)(c.Card.ActionLink,{localizationKey:(0,n.localizationKeys)(t?"reverification.password.actionLink":"reverification.alternativeMethods.actionLink"),onClick:t||u})})]})]}),(0,o.tZ)(c.Card.Footer,{})]})})}function L(e,t){return"primary"in e&&e.primary&&!("primary"in t&&t.primary)?-1:"primary"in t&&t.primary&&!("primary"in e&&e.primary)?1:0}let T=e=>{let{session:t}=(0,k.kP)(),r=(0,c.useCardState)(),{handleVerificationResponse:a}=z();i.useEffect(()=>{e.factorAlreadyPrepared||n()},[]);let n=()=>{t.prepareFirstFactorVerification(e.factor).then(()=>e.onFactorPrepare()).catch(e=>(0,p.S3)(e,[],r.setError))};return(0,o.tZ)(c.VerificationCodeCard,{cardTitle:e.cardTitle,cardSubtitle:e.cardSubtitle,inputLabel:e.inputLabel,resendButton:e.resendButton,onCodeEntryFinishedAction:(r,o,i)=>{t.attemptFirstFactorVerification({strategy:e.factor.strategy,code:r}).then(async e=>(await o(),a(e))).catch(i)},onResendCodeClicked:n,safeIdentifier:e.factor.safeIdentifier,profileImageUrl:t?.user?.imageUrl,onShowAlternativeMethodsClicked:e.onShowAlternativeMethodsClicked,showAlternativeMethods:e.showAlternativeMethods,onBackLinkClicked:e.onBackLinkClicked})},I=e=>(0,o.tZ)(n.Flow.Part,{part:"emailCode",children:(0,o.tZ)(T,{...e,cardTitle:(0,n.localizationKeys)("reverification.emailCode.title"),cardSubtitle:(0,n.localizationKeys)("reverification.emailCode.subtitle"),inputLabel:(0,n.localizationKeys)("reverification.emailCode.formTitle"),resendButton:(0,n.localizationKeys)("reverification.emailCode.resendButton")})}),P=e=>{let{onShowAlternativeMethodsClicked:t}=e,{session:r}=(0,k.kP)(),{__internal_isWebAuthnSupported:i}=(0,k.cL)(),{handleVerificationResponse:a}=z(),l=(0,c.useCardState)(),s=()=>{r?.verifyWithPasskey().then(e=>a(e)).catch(e=>p.S3(e,[],l.setError))};return(0,o.BX)(c.Card.Root,{children:[(0,o.BX)(c.Card.Content,{children:[(0,o.BX)(c.Header.Root,{showLogo:!0,children:[(0,o.tZ)(c.Header.Title,{localizationKey:(0,n.localizationKeys)("reverification.passkey.title")}),(0,o.tZ)(c.Header.Subtitle,{localizationKey:(0,n.localizationKeys)("reverification.passkey.subtitle")})]}),(0,o.tZ)(c.Card.Alert,{children:l.error}),(0,o.tZ)(n.Col,{elementDescriptor:n.descriptors.main,gap:8,children:(0,o.tZ)(c.Form.Root,{children:(0,o.BX)(n.Col,{gap:3,children:[(0,o.tZ)(n.Button,{type:"button",onClick:e=>{e.preventDefault(),s()},localizationKey:(0,n.localizationKeys)("reverification.passkey.blockButton__passkey"),hasArrow:!0}),(0,o.tZ)(c.Card.Action,{elementId:"alternativeMethods",children:t&&(0,o.tZ)(c.Card.ActionLink,{localizationKey:(0,n.localizationKeys)("footerActionLink__useAnotherMethod"),onClick:t})})]})})})]}),(0,o.tZ)(c.Card.Footer,{})]})},R=e=>(0,o.tZ)(n.Flow.Part,{part:"phoneCode",children:(0,o.tZ)(T,{...e,cardTitle:(0,n.localizationKeys)("reverification.phoneCode.title"),cardSubtitle:(0,n.localizationKeys)("reverification.phoneCode.subtitle"),inputLabel:(0,n.localizationKeys)("reverification.phoneCode.formTitle"),resendButton:(0,n.localizationKeys)("reverification.phoneCode.resendButton"),showAlternativeMethods:e.showAlternativeMethods})}),E=e=>{if(!e)return"";let t=e.strategy;return"emailAddressId"in e&&(t+=e.emailAddressId),"phoneNumberId"in e&&(t+=e.phoneNumberId),t},H=["password","email_code","phone_code","passkey"],X=g((0,c.withCardStateProvider)(function(){let{data:e}=Z(),t=(0,c.useCardState)(),{navigate:r}=(0,l.useRouter)(),n=i.useRef(""),u=(0,i.useMemo)(()=>e.supportedFirstFactors?.filter(e=>H.includes(e.strategy))?.sort(L)||null,[e.supportedFirstFactors]),{preferredSignInStrategy:h}=(0,a.useEnvironment)().displayConfig,[{currentFactor:p},f]=i.useState(()=>({currentFactor:(0,d.t3)(u,null,h),prevCurrentFactor:void 0})),{hasAnyStrategy:y,hasFirstParty:v}=C({filterOutFactor:p,supportedFirstFactors:u}),[k,m]=i.useState(()=>!p||!(0,d.xT)(p)),b=y?()=>{t.setError(void 0),m(e=>!e)}:void 0,g=()=>{n.current=E(p)},w=e=>{f(t=>({currentFactor:e,prevCurrentFactor:t.currentFactor}))};if((0,i.useEffect)(()=>{"needs_second_factor"===e.status&&r("factor-two")},[]),!p)return(0,o.tZ)(c.ErrorCard,{cardTitle:(0,s.u1)("reverification.noAvailableMethods.title"),cardSubtitle:(0,s.u1)("reverification.noAvailableMethods.subtitle"),message:(0,s.u1)("reverification.noAvailableMethods.message"),shouldNavigateBack:!1});if(k){let e=(0,d.xT)(p);return(0,o.tZ)(F,{onBackLinkClick:e?()=>{t.setError(void 0),b?.()}:void 0,onFactorSelected:e=>{w(e),b?.()},currentFactor:p})}switch(p?.strategy){case"password":return(0,o.tZ)(K,{onShowAlternativeMethodsClick:b});case"email_code":return(0,o.tZ)(I,{factorAlreadyPrepared:n.current===E(p),onFactorPrepare:g,onShowAlternativeMethodsClicked:b,factor:p,showAlternativeMethods:v});case"phone_code":return(0,o.tZ)(R,{factorAlreadyPrepared:n.current===E(p),onFactorPrepare:g,onShowAlternativeMethodsClicked:b,factor:p,showAlternativeMethods:v});case"passkey":return(0,o.tZ)(P,{onShowAlternativeMethodsClicked:b});default:return(0,o.tZ)(c.LoadingCard,{})}})),x=e=>{let t=(0,c.useCardState)(),{session:r}=(0,k.kP)(),{handleVerificationResponse:a}=z();i.useEffect(()=>{!e.factorAlreadyPrepared&&n?.()},[]);let n=e.prepare?()=>e.prepare?.().then(()=>e.onFactorPrepare()).catch(e=>p.S3(e,[],t.setError)):void 0;return(0,o.tZ)(c.VerificationCodeCard,{cardTitle:e.cardTitle,cardSubtitle:e.cardSubtitle,resendButton:e.resendButton,inputLabel:e.inputLabel,onCodeEntryFinishedAction:(t,o,i)=>{r.attemptSecondFactorVerification({strategy:e.factor.strategy,code:t}).then(async e=>(await o(),a(e))).catch(i)},onResendCodeClicked:n,safeIdentifier:"safeIdentifier"in e.factor?e.factor.safeIdentifier:void 0,profileImageUrl:r?.user?.imageUrl,onShowAlternativeMethodsClicked:e.onShowAlternativeMethodsClicked,showAlternativeMethods:e.showAlternativeMethods})};function V(e){return(0,o.tZ)(n.Flow.Part,{part:"totp2Fa",children:(0,o.tZ)(x,{...e,cardTitle:(0,n.localizationKeys)("reverification.totpMfa.title"),cardSubtitle:(0,n.localizationKeys)("reverification.totpMfa.subtitle"),inputLabel:(0,n.localizationKeys)("reverification.totpMfa.formTitle"),showAlternativeMethods:e.showAlternativeMethods})})}let D=e=>{let[t,r]=i.useState(!1),a=i.useCallback(()=>r(e=>!e),[r]);return t?(0,o.tZ)(w,{onBackLinkClick:a}):(0,o.tZ)(N,{supportedSecondFactors:e.supportedSecondFactors,onBackLinkClick:e.onBackLinkClick,onFactorSelected:e.onFactorSelected,onHavingTroubleClick:a})},N=e=>{let{supportedSecondFactors:t,onHavingTroubleClick:r,onFactorSelected:i,onBackLinkClick:a}=e,l=(0,u.v)();return(0,o.tZ)(n.Flow.Part,{part:"alternativeMethods",children:(0,o.BX)(c.Card.Root,{children:[(0,o.BX)(c.Card.Content,{children:[(0,o.BX)(c.Header.Root,{showLogo:!0,children:[(0,o.tZ)(c.Header.Title,{localizationKey:(0,n.localizationKeys)("reverification.alternativeMethods.title")}),(0,o.tZ)(c.Header.Subtitle,{localizationKey:(0,n.localizationKeys)("reverification.alternativeMethods.subtitle")})]}),(0,o.tZ)(c.Card.Alert,{children:l.error}),(0,o.BX)(n.Col,{elementDescriptor:n.descriptors.main,gap:3,children:[(0,o.tZ)(n.Col,{gap:2,children:t?.sort(p.Q0).map((e,t)=>o.tZ(c.ArrowBlockButton,{textLocalizationKey:function(e){switch(e.strategy){case"phone_code":return(0,n.localizationKeys)("reverification.alternativeMethods.blockButton__phoneCode",{identifier:(0,p.HT)(e.safeIdentifier)||""});case"totp":return(0,n.localizationKeys)("reverification.alternativeMethods.blockButton__totp");case"backup_code":return(0,n.localizationKeys)("reverification.alternativeMethods.blockButton__backupCode");default:throw Error(`Invalid verification strategy: "${e.strategy}"`)}}(e),elementDescriptor:n.descriptors.alternativeMethodsBlockButton,textElementDescriptor:n.descriptors.alternativeMethodsBlockButtonText,arrowElementDescriptor:n.descriptors.alternativeMethodsBlockButtonArrow,isDisabled:l.isLoading,onClick:()=>i(e)},t))}),(0,o.tZ)(c.Card.Action,{elementId:"alternativeMethods",children:a&&(0,o.tZ)(c.Card.ActionLink,{localizationKey:(0,n.localizationKeys)("backButton"),onClick:e.onBackLinkClick})})]})]}),(0,o.tZ)(c.Card.Footer,{children:(0,o.BX)(c.Card.Action,{elementId:"havingTrouble",children:[(0,o.tZ)(c.Card.ActionText,{localizationKey:(0,n.localizationKeys)("reverification.alternativeMethods.actionText")}),(0,o.tZ)(c.Card.ActionLink,{localizationKey:(0,n.localizationKeys)("reverification.alternativeMethods.actionLink"),onClick:r})]})})]})})},U=e=>{let{onShowAlternativeMethodsClicked:t}=e,{session:r}=(0,k.kP)(),{handleVerificationResponse:i}=z(),a=(0,c.useCardState)(),l=(0,p.Yp)("code","",{type:"text",label:(0,n.localizationKeys)("formFieldLabel__backupCode"),isRequired:!0});return(0,o.BX)(c.Card.Root,{children:[(0,o.BX)(c.Card.Content,{children:[(0,o.BX)(c.Header.Root,{showLogo:!0,children:[(0,o.tZ)(c.Header.Title,{localizationKey:(0,n.localizationKeys)("reverification.backupCodeMfa.title")}),(0,o.tZ)(c.Header.Subtitle,{localizationKey:(0,n.localizationKeys)("reverification.backupCodeMfa.subtitle")})]}),(0,o.tZ)(c.Card.Alert,{children:a.error}),(0,o.tZ)(n.Col,{elementDescriptor:n.descriptors.main,gap:8,children:(0,o.BX)(c.Form.Root,{onSubmit:e=>(e.preventDefault(),r.attemptSecondFactorVerification({strategy:"backup_code",code:l.value}).then(i).catch(e=>(0,p.S3)(e,[l],a.setError))),children:[(0,o.tZ)(c.Form.ControlRow,{elementId:l.id,children:(0,o.tZ)(c.Form.PlainInput,{...l.props,autoFocus:!0,onActionClicked:t})}),(0,o.BX)(n.Col,{gap:3,children:[(0,o.tZ)(c.Form.SubmitButton,{hasArrow:!0}),(0,o.tZ)(c.Card.Action,{elementId:"alternativeMethods",children:t&&(0,o.tZ)(c.Card.ActionLink,{localizationKey:(0,n.localizationKeys)("footerActionLink__useAnotherMethod"),onClick:t})})]})]})})]}),(0,o.tZ)(c.Card.Footer,{})]})},W=e=>{let{session:t}=(0,k.kP)();return(0,o.tZ)(n.Flow.Part,{part:"phoneCode2Fa",children:(0,o.tZ)(x,{...e,cardTitle:(0,n.localizationKeys)("reverification.phoneCodeMfa.title"),cardSubtitle:(0,n.localizationKeys)("reverification.phoneCodeMfa.subtitle"),inputLabel:(0,n.localizationKeys)("reverification.phoneCodeMfa.formTitle"),resendButton:(0,n.localizationKeys)("reverification.phoneCodeMfa.resendButton"),prepare:()=>{let{phoneNumberId:r,strategy:o}=e.factor;return t.prepareSecondFactorVerification({phoneNumberId:r,strategy:o})}})})},j=e=>{if(!e)return"";let t=e.strategy;return"phoneNumberId"in e&&(t+=e.phoneNumberId),t},G=["phone_code","totp","backup_code"],$=g((0,c.withCardStateProvider)(function(){let{navigate:e}=(0,l.useRouter)(),{data:t}=Z(),r=(0,i.useMemo)(()=>t.supportedSecondFactors?.filter(e=>G.includes(e.strategy))?.sort(L)||null,[t.supportedSecondFactors]),a=i.useRef(""),[n,s]=i.useState(()=>(0,d.bx)(r)),[u,h]=i.useState(!n),p=()=>h(e=>!e),f=(0,i.useMemo)(()=>r?.filter(e=>!v(e,n)),[r,n]),y=()=>{a.current=j(n)},C=(0,i.useMemo)(()=>f&&f.length>0||!1,[f]);if((0,i.useEffect)(()=>{"needs_first_factor"===t.status&&e("../")},[]),!n)return(0,o.tZ)(c.LoadingCard,{});if(u&&C)return(0,o.tZ)(D,{supportedSecondFactors:f||null,onBackLinkClick:p,onFactorSelected:e=>{s(e),p()}});switch(n?.strategy){case"phone_code":return(0,o.tZ)(W,{factorAlreadyPrepared:a.current===j(n),onFactorPrepare:y,factor:n,onShowAlternativeMethodsClicked:p,showAlternativeMethods:C});case"totp":return(0,o.tZ)(V,{factorAlreadyPrepared:a.current===j(n),onFactorPrepare:y,factor:n,onShowAlternativeMethodsClicked:p,showAlternativeMethods:C});case"backup_code":return(0,o.tZ)(U,{onShowAlternativeMethodsClicked:p});default:return(0,o.tZ)(c.LoadingCard,{})}}));function O(){let{invalidate:e}=Z();return(0,i.useEffect)(()=>()=>{e()},[]),(0,o.tZ)(n.Flow.Root,{flow:"userVerification",children:(0,o.BX)(l.Switch,{children:[(0,o.tZ)(l.Route,{path:"factor-two",children:(0,o.tZ)($,{})}),(0,o.tZ)(l.Route,{index:!0,children:(0,o.tZ)(X,{})})]})})}O.displayName="UserVerification";let Q=(0,a.withCoreSessionSwitchGuard)(O),Y=e=>(0,o.tZ)(l.Route,{path:"user-verification",children:(0,o.tZ)(a.UserVerificationContext.Provider,{value:{componentName:"UserVerification",...e,routing:"virtual"},children:(0,o.tZ)("div",{children:(0,o.tZ)(Q,{...e,routing:"virtual"})})})})}}]);